game.import("extension",function(lib,game,ui,get,ai,_status){return {name:"舰R牌将",content:function (config,pack){
	if(config.jianrjinji){
		for(var i in lib.characterPack['jianrjinji']) {
			if(lib.character[i][4].indexOf("forbidai")<0) lib.character[i][4].push("forbidai");
		};
	};//选项触发内容，原因见config
},precontent:function(jianrjinji){
	if(jianrjinji.enable){
		//武将包
		game.import('character',function(){
			var jianrjinji={
				name:'jianrjinji',//武将包命名（必填）
				connect:true,//该武将包是否可以联机（必填）
		character:{
		addskilltest:["male","wei",9,["yuanhang","fangkoganning"],["forbidai","des:测试用"]],
        
            liekexingdun:["female","wu",4,["hangmucv","yuanhang","zhangba_skill","kanpolimitai","roundonefire","danzong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["zhu","des:血量中等的航母，温柔，体贴，过渡期追着大船打的航母。"]],
            chicheng:["female","wu",4,["hangmucv","yuanhang","zhangba_skill","kanpolimitai","roundonefire","danzong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:大佬友情放出精美壁纸，坚定与自信的姿态"]],
            bisimai:["female","shu",4,["yuanhang","zhanliebb","huokongld","zhuangjiafh","fupaozu","danzong","lingxue","huijiahuihe","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["zhu","des:更多刮痧，更多力量，更多护甲，更高血量。"]],
            misuli:["female","shu",4,["yuanhang","zhanliebb","huokongld","zhuangjiafh","fupaozu","danzong","lingxue","huijiahuihe","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:用精巧的手枪去质疑，用绝对的火力回击对手。"]],
            lizhan:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:这是个依赖科技的舰船，有着科幻的舰装，与兼备温柔体贴与意气风发的表现。"]],
            
            kunxi:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:画师优秀的功底让这名角色美而可爱，这是出色的角色塑造。"]],
            ougengqi:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:励志偶像，与标志性舰装，可惜没有适合的图与技能用于无名杀"]],
            yixian:["female","wei",3,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","qingnang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:经典美术设计的款式，意气风发，威猛先生"]],
            haiwangxing:["female","wei",3,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","qingnang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:阻敌计谋表现优秀，这是先发制敌的优势所在，"]],
            rending:["female","wei",3,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:手持竹伞的轻巡，辅助队友，防御攻击。"]],
            "z31":["female","wei",3,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","zhangba_skill","huihejieshu","jianzaochuan","qigong","wulidebuff","qianghuazhuang"],["des:婚纱与轻纱是多数人的美梦,与绿草平原，与绿水青山"]],
            xuefeng:["female","wei",3,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","qigong","zhangba_skill","huihejieshu","jianzaochuan","wulidebuff","qianghuazhuang"],["des:幸运的驱逐舰，多位画师、花了大款的大佬亲情奉献。"]],
            kangfusi:["female","wei",3,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","zhangba_skill","huihejieshu","jianzaochuan","qigong","wulidebuff","qianghuazhuang"],["des:水手服欸,优秀的构图，不过图少改造晚。"]],
            "u1405":["female","shu",2,["yuanhang","qianting","jiezi","danzong","touxichuan","baiyin_skill","new_retuxi","foundtrick","rendeonly2","roundonefire","olniepan","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:无需隐匿的偷袭大师，马上就让对手的后勤捉襟见肘。"]],
            jingjishen:["female","wu",3,["junfu","yuanhang","huihejieshu","jianzaochuan","reyaowu","chouce","diewulimitai","wulidebuff","qianghuazhuang"],["des:需要武器支援，伙计倒下了。"]],
            changchun:["female","wu",3,["daoqu","tianyi","zhangba_skill","yuanhang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:尚处于正能量之时。"]],
        },
			};
			if(lib.device||lib.node){
				for(var i in jianrjinji.character){jianrjinji.character[i][4].push('ext:舰R牌将/'+i+'.jpg');}
			}else{
				for(var i in jianrjinji.character){jianrjinji.character[i][4].push('db:extension-舰R牌将:'+i+'.jpg');}
			}//由于以此法加入的武将包武将图片是用源文件的，所以要用此法改变路径
			return jianrjinji;
		});
		lib.config.all.characters.push('jianrjinji');
		if(!lib.config.characters.contains('jianrjinji')) lib.config.characters.push('jianrjinji');
		lib.translate['jianrjinji_character_config']='舰R竞技';// 包名翻译
		//卡包（手牌）
		game.import('card',function(){
			var jianrjinjibao={
			name:'jianrjinjibao',//卡包命名
			connect:true,//卡包是否可以联机
        card:{   },
				list:[["heart","1","hangkongzhan"],["heart","1","paohuozb"],["heart","1","xingyun"],["heart","1","sansheyl"],["heart","1","jinjuzy"],["heart","1","jiakongls"],["heart","1","mingzuyq"]],//牌堆添加
			}
			return jianrjinjibao
		});
		lib.translate['jianrjinjibao_card_config']='舰R竞技卡包';
		lib.config.all.cards.push('jianrjinjibao');
		if(!lib.config.cards.contains('jianrjinjibao')) lib.config.cards.push('jianrjinjibao');//包名翻译
	};
},help:{},config:{"jianrjinji":{"name":"将舰R竞技内武将设为禁用","init":false}},package:{
    character:{
        character:{
            "u1405":["female","shu",1,["yuanhang","qianting","danzong","touxichuan","baiyin_skill","new_retuxi","foundtrick","rendeonly2","roundonefire","olniepan","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:无需隐匿的偷袭大师，马上就让对手的后勤捉襟见肘。"]],
            haiwangxing:["female","wei",2,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","qingnang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:阻敌计谋表现优秀，这是先发制敌的优势所在，"]],
            liekexingdun:["female","wu",4,["hangmucv","yuanhang","zhangba_skill","kanpolimitai","roundonefire","danzong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["zhu","des:血量中等的航母，温柔，体贴，过渡期追着大船打的航母。"]],
            chicheng:["female","wu",4,["hangmucv","yuanhang","zhangba_skill","kanpolimitai","roundonefire","danzong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:大佬友情放出精美壁纸，坚定与自信的姿态"]],
            bisimai:["female","shu",4,["yuanhang","zhanliebb","huokongld","zhuangjiafh","fupaozu","danzong","lingxue","huijiahuihe","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["zhu","des:更多刮痧，更多力量，更多护甲，更高血量。"]],
            lizhan:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:这是个依赖科技的舰船，有着科幻的舰装，与兼备温柔体贴与意气风发的表现。"]],
            xuefeng:["female","wei",2,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","qigong","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:幸运的驱逐舰，多位画师、花了大款的大佬亲情奉献。"]],
            addskilltest:["male","wei",9,["yuanhang","fangkoganning"],["forbidai","des:测试用"]],
            kunxi:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:画师优秀的功底让这名角色美而可爱，这是出色的角色塑造。"]],
            misuli:["female","shu",4,["yuanhang","zhanliebb","huokongld","zhuangjiafh","fupaozu","danzong","lingxue","huijiahuihe","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:用精巧的手枪去质疑，用绝对的火力回击对手。"]],
            yixian:["female","wei",2,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","qingnang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:经典美术设计的款式，意气风发，威猛先生"]],
            "z31":["female","wei",2,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","zhangba_skill","huihejieshu","jianzaochuan","qigong","diewulimitai","wulidebuff","qianghuazhuang"],["des:婚纱与轻纱是多数人的美梦,与绿草平原，与绿水青山"]],
            ougengqi:["female","shu",4,["zhongxunca","yuanhang","zhuangjiafh","fupaozu","danzong","huijiahuihe","huokongld","zhangba_skill","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:励志偶像，与标志性舰装，可惜没有适合的图与技能用于无名杀"]],
            kangfusi:["female","wei",2,["yuanhang","quzhudd","huibi","hongyuan","rendeonly2","danzong","zhangba_skill","huihejieshu","jianzaochuan","qigong","diewulimitai","wulidebuff","qianghuazhuang"],["des:水手服欸,优秀的构图，不过图少改造晚。"]],
            rending:["female","wei",2,["yuanhang","qingxuncl","danzong","fangkoganning","xianjinld","huibi","qigong","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:手持竹伞的轻巡，辅助队友，防御攻击。"]],
            jingjishen:["female","wu",3,["junfu","yuanhang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:需要武器支援，伙计倒下了。"]],
            changchun:["female","wu",3,["daoqu","fangtian_skill","zhangba_skill","yuanhang","huihejieshu","jianzaochuan","diewulimitai","wulidebuff","qianghuazhuang"],["des:尚处于正能量之时。"]],
        },
        translate:{
            "u1405":"u1405",
            haiwangxing:"海王星轻巡",
            liekexingdun:"列克星敦",
            chicheng:"赤城航母",
            bisimai:"俾斯麦&北宅",
            lizhan:"历战重巡",
            xuefeng:"雪风驱逐",
            addskilltest:"addskilltest",
            kunxi:"昆西重巡",
            misuli:"密苏里战列",
            yixian:"逸仙轻巡",
            "z31":"z31驱逐",
            ougengqi:"欧根重巡",
            kangfusi:"康弗斯驱逐",
            rending:"仁淀轻巡",
            jingjishen:"竞技神",
            changchun:"长春",
        },
    },
    card:{
        card:{
            jinjuzy:{
                audio:true,
                type:"trick",
                enable:true,
                selectTarget:-1,
                reverseOrder:true,
                "yingbian_prompt":"当你使用此牌选择目标后，你可为此牌减少一个目标",
                "yingbian_tags":["remove"],
                yingbian:function(event){
        event.yingbian_removeTarget=true;
    },
                filterTarget:function(card,player,target){
        return get.attitude(player,target)<0&&player.getEquip(2)!='tengjia';
    },
                content:function(){
        "step 0"
        if(typeof event.baseDamage!='number') event.baseDamage=1;
        if(event.directHit) event._result={bool:false};
        else{
            var next=target.chooseToRespond({name:'shan'});
            next.set('ai',function(card){
                var evt=_status.event.getParent();
                if(get.damageEffect(evt.target,evt.player,evt.target)>=0) return 0;
                if(evt.player.hasSkillTag('notricksource')) return 0;
                if(evt.target.hasSkillTag('notrick')) return 0;
                if(evt.target.hasSkillTag('noShan')){
                    return -1;
                }
            return get.order(card);
            });
            next.autochoose=lib.filter.autoRespondShan;
        }
        "step 1"
        if(result.bool==false){
            target.damage(event.baseDamage);
        }
    },
                ai:{
                    wuxie:function(target,card,player,viewer){
            if(get.attitude(viewer,target)>0&&target.countCards('h','shan')){
                if(!target.countCards('h')||target.hp==1||Math.random()<0.7) return 0;
            }
        },
                    basic:{
                        order:9,
                        useful:1,
                        value:7,
                    },
                    result:{
                        "target_use":function(player,target){
                if(player.hasUnknown(2)&&get.mode()!='guozhan') return 0;
                var nh=target.countCards('h');
                if(get.mode()=='identity'){
                    if(target.isZhu&&nh<=2&&target.hp<=1) return -100;
                }
                if(nh==0) return -2;
                if(nh==1) return -1.7
                return -1.5;
            },
                        target:function(player,target){
                var nh=target.countCards('h');
                if(get.mode()=='identity'){
                    if(target.isZhu&&nh<=2&&target.hp<=1) return -100;
                }
                if(nh==0) return -2;
                if(nh==1) return -1.7
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:1,
                        multitarget:1,
                        multineg:1,
                    },
                },
                fullimage:true,
            },
            jiakongls:{
                audio:true,
                type:"trick",
                enable:true,
                cardcolor:"red",
                selectTarget:-1,
                filterTarget:true,
                contentBefore:function(){
        "step 0"
        if(!targets.length){
            event.finish();
            return;
        }
        if(get.is.versus()){
            player.chooseControl('顺时针','逆时针',function(event,player){
                if(player.next.side==player.side) return '逆时针';
                return '顺时针';
            }).set('prompt','选择'+get.translation(card)+'的结算方向');
        }
        else{
            event.goto(2);
        }
        "step 1"
        if(result&&result.control=='顺时针'){
            var evt=event.getParent(),sorter=(_status.currentPhase||player);
            evt.fixedSeat=true;
            evt.targets.sortBySeat(sorter);
            evt.targets.reverse();
            if(evt.targets[evt.targets.length-1]==sorter){
                evt.targets.unshift(evt.targets.pop());
            }
        }
        "step 2"
        ui.clear();
        var num;
        if(event.targets){
            num=Math.floor(event.targets.length*1.5);
        }
        else{
            num=game.countPlayer()*2;
        }
        var cards=get.cards(num);
        game.cardsGotoOrdering(cards).relatedEvent=event.getParent();
        var dialog=ui.create.dialog('五谷丰登',cards,true);
        _status.dieClose.push(dialog);
        dialog.videoId=lib.status.videoId++;
        game.addVideo('cardDialog',null,['五谷丰登',get.cardsInfo(cards),dialog.videoId]);
        event.getParent().preResult=dialog.videoId;
        game.broadcast(function(cards,id){
            var dialog=ui.create.dialog('五谷丰登',cards,true);
            _status.dieClose.push(dialog);
            dialog.videoId=id;
        },cards,dialog.videoId);
        game.log(event.card,'亮出了',cards);
    },
                content:function(){
        "step 0"
        for(var i=0;i<ui.dialogs.length;i++){
            if(ui.dialogs[i].videoId==event.preResult){
                event.dialog=ui.dialogs[i];break;
            }
        }
        if(!event.dialog){
            event.finish();
            return;
        }
        if(event.dialog.buttons.length>1){
            var next=target.chooseButton(true,function(button){
                return get.value(button.link,_status.event.player);
            });
            next.set('dialog',event.preResult);
            next.set('closeDialog',false);
            next.set('dialogdisplay',true);
        }
        else{
            event.directButton=event.dialog.buttons[0];
        }
        "step 1"
        var dialog=event.dialog;
        var card;
        if(event.directButton){
            card=event.directButton.link;
        }
        else{
            for(var i of dialog.buttons){
                if(i.link==result.links[0]){
                    card=i.link;
                    break;
                }
            }
            if(!card) card=event.dialog.buttons[0].link;
        }

        var button;
        for(var i=0;i<dialog.buttons.length;i++){
            if(dialog.buttons[i].link==card){
                button=dialog.buttons[i];
                button.querySelector('.info').innerHTML=function(target){
                    if(target._tempTranslate) return target._tempTranslate;
                    var name=target.name;
                    if(lib.translate[name+'_ab']) return lib.translate[name+'_ab'];
                    return get.translation(name);
                }(target);
                dialog.buttons.remove(button);
                break;
            }
        }
        var capt=get.translation(target)+'选择了'+get.translation(button.link);
        if(card){
            target.gain(card,'visible');
            target.$gain2(card);
            game.broadcast(function(card,id,name,capt){
                var dialog=get.idDialog(id);
                if(dialog){
                    dialog.content.firstChild.innerHTML=capt;
                    for(var i=0;i<dialog.buttons.length;i++){
                        if(dialog.buttons[i].link==card){
                            dialog.buttons[i].querySelector('.info').innerHTML=name;
                            dialog.buttons.splice(i--,1);
                            break;
                        }
                    }
                }
            },card,dialog.videoId,function(target){
                if(target._tempTranslate) return target._tempTranslate;
                var name=target.name;
                if(lib.translate[name+'_ab']) return lib.translate[name+'_ab'];
                return get.translation(name);
            }(target),capt);
        }
        dialog.content.firstChild.innerHTML=capt;
        game.addVideo('dialogCapt',null,[dialog.videoId,dialog.content.firstChild.innerHTML]);
        game.log(target,'选择了',button.link);
        game.delay();
    },
                contentAfter:function(){
        for(var i=0;i<ui.dialogs.length;i++){
            if(ui.dialogs[i].videoId==event.preResult){
                var dialog=ui.dialogs[i];
                dialog.close();
                _status.dieClose.remove(dialog);
                if(dialog.buttons.length){
                    event.remained=[];
                    for(var i=0;i<dialog.buttons.length;i++){
                        event.remained.push(dialog.buttons[i].link);
                    }
                    event.trigger('wuguRemained');
                }
                break;
            }
        }
        game.broadcast(function(id){
            var dialog=get.idDialog(id);
            if(dialog){
                dialog.close();
                _status.dieClose.remove(dialog);
            }
        },event.preResult);
        game.addVideo('cardDialog',null,event.preResult);if(!player.countMark('jiakongls')){player.addMark('jiakongls');player.chooseUseTarget(true,'jiakongls')};
    },
                ai:{
                    wuxie:function(){
            if(Math.random()<0.5) return 0;
        },
                    basic:{
                        order:10,
                        useful:0.5,
                    },
                    result:{
                        target:function(player,target){
                var sorter=(_status.currentPhase||player);
                if(get.is.versus()){
                    if(target==sorter) return 1.5;
                    return 1;
                }
                if(player.hasUnknown(2)){
                    return 0;
                }
                return (3-get.distance(sorter,target,'absolute')/game.countPlayer())*get.attitude(player,target)>0?0.5:0.7;
            },
                    },
                    tag:{
                        draw:1,
                        multitarget:1,
                    },
                },
                fullimage:true,
            },
            mingzuyq:{
                audio:true,
                mode:["guozhan"],
                type:"equip",
                subtype:"equip5",
                distance:{
                    attackFrom:-1,
                },
                nomod:true,
                nopower:true,
                unique:true,
                global:"g_dinglanyemingzhu_ai",
                skills:["dinglanyemingzhu_skill"],
                ai:{
                    equipValue:function(card,player){
            if(player.hasSkill('jubao')) return 8;
            if(player.hasSkill('gzzhiheng')) return 6;
            if(game.hasPlayer(function(current){
                return current.hasSkill('jubao')&&get.attitude(player,current)<=0;
            })){
                return 0;
            }
            return 7;
        },
                    basic:{
                        equipValue:6.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
                fullimage:true,
            },
            hangkongzhan:{
                type:"equip",
                subtype:"equip4",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:7.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:["roundonefire"],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
                fullimage:true,
            },
            paohuozb:{
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-2,
                },
                ai:{
                    basic:{
                        equipValue:2,
                        order:function(card,player){if(player.hp>2)return true
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 2.5-get.equipValue(card,player)/20;
                }
                else{
                    return 0+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.hp<2||player.countCards('h','sha')<1||!player.canUse('sha',player))return 0.01
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:["paohuozb_skill","danzong"],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:false,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
                fullskin:true,
            },
            xingyun:{
                derivation:"majun",
                type:"equip",
                subtype:"equip3",
                ai:{
                    basic:{
                        equipValue:7.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:["huibi"],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:false,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:false,
                fullimage:true,
            },
            sansheyl:{
                type:"basic",
                cardcolor:"club",
                derivation:"gjqt_xieyi",
                enable:true,
                notarget:true,
                content:function(){
        'step 0'
        var choice='liutouge';
        player.chooseVCardButton('选择一张牌视为使用之',['sha','sha','sha']).set('ai',function(button){
            if(button.link[2]==_status.event.choice) return 2;
            return Math.random();
        }).set('choice',choice).set('filterButton',function(button){
            return _status.event.player.hasUseTarget(button.link[2]);
        });
        'step 1'
        if(result.bool){
        player.chooseUseTarget(result.links[0][2]);player.chooseUseTarget(result.links[0][2]);}else event.finish;
    },
                ai:{
                    order:5,
                    result:{
                        player:1,
                    },
                },
                fullimage:true,
            },
            "quzhupao3":{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
            "qingxunpao3":{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
            "zhongxunpao3":{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
            "zhanliepao3":{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
            "zhandouji3":{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
            huokongld:{
                fullskin:true,
                type:"equip",
                subtype:"equip1",
                distance:{
                    attackFrom:-1,
                },
                ai:{
                    basic:{
                        equipValue:2.5,
                        order:function(card,player){
                if(player&&player.hasSkillTag('reverseEquip')){
                    return 8.5-get.equipValue(card,player)/20;
                }
                else{
                    return 8+get.equipValue(card,player)/20;
                }
            },
                        useful:2,
                        value:function(card,player,index,method){
                if(player.isDisabled(get.subtype(card))) return 0.01;
                var value=0;
                var info=get.info(card);
                var current=player.getEquip(info.subtype);
                if(current&&card!=current){
                    value=get.value(current,player);
                }
                var equipValue=info.ai.equipValue;
                if(equipValue==undefined){
                    equipValue=info.ai.basic.equipValue;
                }
                if(typeof equipValue=='function'){
                    if(method=='raw') return equipValue(card,player);
                    if(method=='raw2') return equipValue(card,player)-value;
                    return Math.max(0.1,equipValue(card,player)-value);
                }
                if(typeof equipValue!='number') equipValue=0;
                if(method=='raw') return equipValue;
                if(method=='raw2') return equipValue-value;
                return Math.max(0.1,equipValue-value);
            },
                    },
                    result:{
                        target:function(player,target,card){
                return get.equipResult(player,target,card.name);
            },
                    },
                },
                skills:[],
                enable:true,
                selectTarget:-1,
                filterTarget:function(card,player,target){
        return target==player;
    },
                modTarget:true,
                allowMultiple:false,
                content:function(){
        if(cards.length&&get.position(cards[0],true)=='o') target.equip(cards[0]);
    },
                toself:true,
            },
        },
        translate:{
            jinjuzy:"近距支援",
            "jinjuzy_info":"出牌阶段，对所有其他角色使用。每名目标角色需打出一张【闪】，否则受到1点伤害。",
            jiakongls:"架空历史",
            "jiakongls_info":"群星璀璨，欧陆风云，该武将首次使用会有两轮1.5展示牌量的五谷丰登，再次使用仅有一轮。",
            mingzuyq:"民族乐器",
            "mingzuyq_info":"北境之地的文化艺术。锁定技，你视为拥有技能“制衡”，若你已经有“制衡”，则改为取消弃置牌数的限制。",
            hangkongzhan:"航空战",
            "hangkongzhan_info":"建树丰厚，参与每轮开始时的三连杀战斗吗，每轮最多弃置三张牌。",
            paohuozb:"炮火准备",
            "paohuozb_info":"试试就逝世，扣一血得属性杀增伤一次，然而现在所有舰船都有这个，可以图加一杀次数。",
            xingyun:"幸运",
            "xingyun_info":"可以进行一次判定，为桃、闪则视为打出闪。<br>若判定未生效,会获得判定牌。<br>若武将为驱逐且没有判定成功，可以额外触发一次。",
            sansheyl:"攻击",
            "sansheyl_info":"其实就是杀，但此杀能连打两次。。",
            "sushepao3":"速射炮",
            "sushepao3_info":"没有特殊效果",
            "quzhupao3":"驱逐速射炮",
            "quzhupao3_info":"",
            "qingxunpao3":"轻巡两用炮",
            "qingxunpao3_info":"",
            "zhongxunpao3":"重巡主炮",
            "zhongxunpao3_info":"",
            "zhanliepao3":"战列主炮",
            "zhanliepao3_info":"",
            "zhandouji3":"制空战斗机",
            "zhandouji3_info":"",
            huokongld:"火控雷达",
            "huokongld_info":"",
        },
        list:[],
    },
    skill:{
        skill:{
            tiaozhanzhuanbei:{
                trigger:{
                    global:"phaseBefore",
                    player:"enterGame",
                },
                forced:true,
                firstDo:true,
                filter:function(event,player){
        return (event.name!='phase'||game.phaseNumber==0)&&get.mode()=='boss';
    },
                content:function(){
        player.equip(game.createCard2('quzhupao3','club',0));
       player.equip(game.createCard2('xingyun','club',0));
        //player.equip(game.createCard2('paohuozb','club',0));
        player.equip(game.createCard2('miki_binoculars','diamond',0));
    },
                mod:{
                    canBeDiscarded:function(card){
            if(get.position(card)=='e'&&['equip1','equip5','equip6'].contains(get.subtype(card))) return false;
        },
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
                "audioname2":{
                    "key_shiki":"shiki_omusubi",
                },
            },
            danzong:{
                equipSkill:true,
                trigger:{
                    player:"useCard1",
                },
                filter:function(event,player,card){
        if(event.card.name=='sha'&&!event.card.nature) return true;
    },
                audio:"ext:1牌将修改:true",
                usable:2,
                name:"弹种",
                check:function(event,player){
        var eff=0;
        for(var i=0;i<event.targets.length;i++){
            var target=event.targets[i];
            var eff1=get.damageEffect(target,player,player);
            var eff2=get.damageEffect(target,player,player,'fire');
            eff+=eff2;
            eff-=eff1;
        }
        return eff>=0;
    },
                prompt:function(event,player){
   {if(player.hasSkill('quzhudd')||player.hasSkill('qianting')) {return '穿甲鱼雷'};
    if(player.hasSkill('zhanliebb')||player.hasSkill('hangmucv')) {return '弃牌穿甲弹'};
    return '扣血燃烧弹'};
    },
                "prompt2":function(event,player){
   {if(player.hasSkill('quzhudd')||player.hasSkill('qianting')) {return '限两次，令非属性'+get.translation(event.card)+'杀获得雷属性（命中后：目标有护甲时，伤害穿透护甲；减少舰船防御距离1点，<br>增加舰船被集火的效果）'};
    if(player.hasSkill('zhanliebb')||player.hasSkill('hangmucv')) {return '限两次，令非属性'+get.translation(event.card)+'获得（命中后：目标有护甲时，加1伤；减少对手1点防御距离）'};
    return '限两次，令非属性'+get.translation(event.card)+'获得火属性（命中后：目标出牌阶段结束时受到一点火焰伤害，并摸一张牌）。'};
    },
                content:function(){//player.addTempSkill('qinggang_skill','useCard1');
        trigger.card.nature='fire';
        if((player.hasSkill('quzhudd')|player.hasSkill('qianting'))){ trigger.card.nature='thunder'};        if((player.hasSkill('zhanliebb')|player.hasSkill('hangmucv'))){trigger.card.nature='thunder'; player.addTempSkill('hanbing_gai','damageEnd');};
        if(get.itemtype(trigger.card)=='card'){
            var next=game.createEvent('zhuque_clear');
            next.card=trigger.card;
            event.next.remove(next);
            trigger.after.push(next);
            next.setContent(function(){
                delete card.nature;
            });
        }
    },
                intro:{
                    content:function(){
            return get.translation(skill);
        },
                },
            },
            huihejieshu:{
                audio:"ext:1牌将修改:2",
                trigger:{
                    global:"phaseBegin",
                },
                fixed:true,
                silent:true,
                friquent:true,
                content:function(){//else if(!player.countMark('mopaiup')<1&&player.countCards('h','shan')<1){player.draw()}
        var a=player.countMark('mopaiup');var b=player.countMark('yuanhang_mopai');
        if(player==_status.currentPhase&&!player.storage.huijiahuihe){a+=(1);player.addMark('yuanhang_mopai',a-b);};
        if(a>b&&player!=_status.currentPhase){player.addMark('yuanhang_mopai',1);};
     
    },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
                forced:true,
                popup:false,
                group:["huihejieshu_kaishi"],
                subSkill:{
                    kaishi:{
                        trigger:{
                            player:"phaseJieshuBegin",
                        },
                        fixed:true,
                        silent:true,
                        friquent:true,
                        content:function(){
     if(player==trigger.player){if(player.countCards('h','shan')<1){player.draw();if(player.hasSkill('qingxuncl')){player.draw()};};};
    },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
            },
            qianghuachuan:{
                mod:{
                    globalFrom:function(from,to,distance){//这个函数已经设置好发起者,防守者,距离三个对象，同player用就行。不用再加新的
        //from，to，（发起，受到）这两就是player，trigger，可使用相同代码。mod和trigger得考虑对象是否已经有代指。
       //distance也不用加减得到了，直接用就可以，用var，或者return赋值。最好是加减标记的数量，其次是数组类与固定数值。
        //进攻距离 输出distance给所有事件与触发器
return distance-=(from.countMark('rangeup'));},
                    globalTo:function(from,to,distance){//注意这里是技能者要挨牌了，调用to的东西，from的hpmaxHp之类的也可以用，to也一样，
        //防守，肯定加距离，防止顺手牵羊。被boss恶心坏了。费用距离
return distance+=(to.countMark('spendup'));},
                    cardUsable:function( card,player,num){//是技能者卡片使用次数，输出num，注意这个mod函数会遍历技能者各种卡片的使用次数。
         //if会让之后的函数/计算有条件的执行，还可以再接一个函数else，让不满足条件的时候再执行一个函数才｝或者；完成if制作。
         //没有huosha，火杀连牌都不是还行，定义nature吧，
     if(card.name=='sha') return num=num+=(player.countMark('useshaup'))},
                },
                maxHandcard:function(player,num){
        var a=0;if(player.countMark('cunchuup')){var a=a+player.countMark('cunchuup')};
    return num=(num+a);},
                direct:true,
                mark:true,
                init:function(player){//初始化数组，放心不是加法，也不会再执行一次就重置，这个数组设置了就一直存在这个对象上
        //getInfo[666，999]可以指定调出数组里面第x个的内容，最好var一个普通变量出来再调用。 delete 加代码可以删除
        //可以list= lib.skill.qianghuachuan.getInfo列表        lists[1,2,3,4]输出
    if(!player.storage.qianghuachuan) player.storage.qianghuachuan=[0,0,0,0];    },
                getInfo:function(player){//设置于player上的、可以输出数组，在lib.skill.数组 后加getinfo，就可以使用于有对象的地方了
    //，若下面intro的content的function没有player就无法使用storage数组，以及与player有关的其他数据。
    //，遇到error:notdifine变量，function加个player试试
    if(!player.storage.qianghuachuan) player.storage.qianghuachuan=[0,0,0,0];
    return player.storage.qianghuachuan;},
                intro:{
                    marktext:"强化",
                    content:function(storage,player){//介绍内容，没法var content的输出对象，那就return给这个函数内容吧。
       //marktext是武将牌上标记的强化舰船，mark默认显示标记吧，下面是动态介绍，数组有变化info就会变化，intro函数无需触发器，简单一点。
       //我注释又双双被吃了，不要在skill上写注释哦。要在有function的括号里写哦。函数的第二个单词要大写哦。
 var info=lib.skill.qianghuachuan.getInfo(player);
        return '<div class="text center"><span class=thundertext>手牌上限：'+info[0]+'</span><br>　<span class=firetext>攻击次数：'+info[1]+'</span><br><span class=greentext>响应摸牌：'+info[2]+'</span><br>　<span class=yellowtext>机动防御：'+info[3]+'</span></div>'
     ;     },
                },
                enable:"phaseUse",
                usable:2,
                filter:function(event,player){
     //enable能在什么阶段发动，这，么写会变为右下角按钮触发型技能，可以用trigger代替，设计为一个对象进入一个阶段就(被动选择)放，但会失去主动技能预设的一些功能，usable限制使用次数
     //fliter可以调用事件对向和技能使用者，对技能释放的卡片做限制，'het'是游戏预设的简写,见下。md，怎么下面那个会清空注释
     //  handCard手牌 ，equip装备牌，简写时是用于装备区， trick锦囊牌,judge是判定区，其他delay延时性锦囊牌。
     //选择玩家｛标签为装备｝（在手牌区与装备区）的卡片数量大于0，且玩家 能用杀时。lib.filter.cardEnabled({name:'sha'},player));
     //filter内还可以套娃，做更具体的限制，cardEnabled是能不能用卡片，抄一个用用，&&和&可以不用括号连接两个条件。
       var a=player.countMark('cunchuup'),  b=player.countMark('useshaup'), c=player.countMark('mopaiup') , d=player.countMark('spendup'),e=player.countMark('jianzaochuan');
       if (player.countCards('he',{type:'equip'})>0){if((a+b+c+d)>(2+e*2))return false} return player.countCards('he',{type:'equip'})>0;
        ;
    },
                filterCard:{
                    type:"equip",
                },
                position:"he",
                selectCard:1,
                prompt:"你可以弃置一张装备牌，选择一个永久效果升级角色,每回合限两次,最多四次",
                check:function(card){//这个不会清理注释,happy,ai选择什么牌，&&player.getEquip(1)
        //什么时候发动可以加player搬一个卡片数量限制下来，get.value(card)是常用代码，所有可用牌的价值。
        return 40-get.value
    },
                content:function(){
         'step 0'//好&&player.getEquip(1),这个注释不会清除欸。control是返回文字吧，要用==判定，而不是=赋值了
        //，备份代码 ，失误几十次了，怕了。不碰了，没爱了，恨透了，悔恨的泪水。好吧动态的文字不行
     //if(result.control=='防御距离')   player.addMark('spendup',1)&&event.finish ;对于动态选项文字不可行
   //  if(result.control='所有伤害')  player.addMark('atkup',1)&&event.finish    ;
   //  if(result.control=='摸牌次数('+player.countMark('mopaiup')+')')   player.addMark('mopaiup',1)&&event.finish    ;
   //control适合静态文字比如取消，index适合subskill、list与storage协作引导的技能释放，以及生成会变化文本的选项。
   //分步事件是技能自己的阶段、自己的事件，可以作为其他技能的触发条件哦，当然大多数技能触发时也是事件。
         var a=player.countMark('rangeup'),  b=player.countMark('useshaup'), c=player.countMark('mopaiup') , d=player.countMark('spendup')
 player.storage.qianghuachuan=[a,b,c,d];game.log('已强化:',a+b+c+d);
 player.chooseControl('<span class=thundertext>射程('+a+')</span>','<span class=firetext>次数('+b+')</span>','<span class=greentext>摸牌('+c+')</span>','<span class=yellowtext>机动('+d+')</span>','cancel2').set('prompt',get.prompt('qianghuachuan')).set('prompt2','令其中一项数字+1,强化舰船强力之处，〖改造〗舰船薄弱之处,解释：<br>“射程”为：含锦囊牌攻击距离；“次数”为：出杀次数；<br>“摸牌“为：远航的摸牌；“机动”为：含锦囊牌防御距离').set('ai',function(event,player){
            var player=_status.event.player,info=lib.skill.qianghuachuan.getInfo(player);
            if(info[0]<info[3])return 0;
            if(info[3]<info[1]) return 3;
            if(info[1]<info[2]) return 1;
            if(info[2]<=info[0])  return 2;
        });event.list=['cunchuup','useshaup','mopaiup','spendup'];
            'step 1'
         if(result.control!='cancel2'){event.suit = result.control;event.numcsgo = result.index;;game.log('你的选择为:',event.suit,result.index)};if(result.control=='cancel2'){player.gain(event.cards);event.finish};
            player.addMark(event.list[event.numcsgo],event.numkn95);
    //   if(event.numcsgo==0) {player.addMark('rangeup',1)} ;;
            
     //   if(event.numcsgo==1)    {player.addMark('useshaup',1) }   ;;
          
     //   if(event.numcsgo==2) {  player.addMark('mopaiup',1)  }   ;;
     //   if(event.numcsgo==3)   {   player.addMark('spendup',1)   } ;;
                
            var a=player.countMark('cunchuup'),  b=player.countMark('useshaup'), c=player.countMark('mopaiup') , d=player.countMark('spendup')
 player.storage.qianghuachuan=[a,b,c,d];//介绍的更新，update.storage没用过，if没有否则多打点英文“；”被害惨了。
        //下面是ai，md又清理文本没爱了，f--k you ，order为发动先后顺序，大概是7为装完装备，3为桃前，只是比大小罢了
        //result为让不让ai发动技能，player=1是有这个技能就放，可以-player.hp或者-countCard，甚至搬一个技能filter下来
        //配音输名字就行，本体有教程，选项-倒数2文件-导入资源，支持武将名+123
    },
                ai:{
                    order:9,
                    threaten:0,
                    result:{
                        player:function(player){var num=player.countCards('e')-1;
            return num;},
                    },
                },
            },
            jianzaochuan:{
                enable:"chooseToUse",
                limited:false,
                complexCard:true,
                filter:function(event,player){var info=lib.skill.qianghuazhuang.getInfo(player);var a=info[0]+info[1]+info[2]+info[3];//下面限制手牌数是优化原版ui的技能显示，没可能用就不显示。
        if(event.type=='dying'){
            if(player!=event.dying) return false;
            return player.countCards('he')>=3;
        }
        else if(event.parent.name=='phaseUse'&&(a)>0){
            return (player.countCards('he')>=3)&&a;;
        }return false},
                selectCard:3,
                position:"he",
                filterCard:function(card,player){
        if(ui.selected.cards.length){
            return get.suit(card)==get.suit(ui.selected.cards[0]);
        }
        var cards=player.getCards('he');
        for(var i=0;i<cards.length;i++){
            if(card!=cards[i]){
                if(get.suit(card)==get.suit(cards[i])) return true
            }
        }
        return false;
    },
                check:function(card){
        var player=_status.event.player;var event=_status.event;var huifu=player.countCards('h','jiu')+player.countCards('h','tao');
       if(player!=event.dying&&(player.hp<player.maxHp)&&(player.countCards('h')>4)) return 8-get.value(card);
        if(player.hp<=0&&(huifu<(-player.hp+1)||!player.hasMark('jianzaochuan')))  return 15-get.value(card);
    },
                prompt:"你可以弃置三张同花色的牌，提升一点血量上限，再回复2点体力。重复建造只会回一点血。",
                content:function(){//skillAnimation:true,当此角色强化了两次以后.最大血量大于3会再加1点体力上限，player.awakenSkill('jianzaochuan')是新版本觉醒技与限定技自动完成隐藏的函数，不需要再设置数组了，不过显示还是要limited来干
        //player:function(player,card){    if(!player.hasMark('yuanhang_bingsimopai')){player.gainMaxHp(1)};
           //      if((player.countCard(h)-player.countMark('gaizhaoup'))>player.maxHp/2)return 1;  },   
        ;player.recover();
if(player.countMark('jianzaochuan')<1){player.gainMaxHp(1);player.recover();} ;
 player.addMark('jianzaochuan'); },
                ai:{
                    save:true,
                    expose:0,
                    threaten:0,
                    order:2,
                    result:{
                        player:function(player){var huifu=player.countCards('h','jiu')+player.countCards('h','tao');
                if(player.hp<=0&&(huifu<(-player.hp+1)||!player.hasMark('jianzaochuan'))) return 10;
                if((player.hp<player.maxHp)&&(player.countCards('h')>4)) {return 10;};
                return 0;
            },
                    },
                },
            },
            "paohuozb_skill":{
                mod:{
                    maxHandcard:function(player,num){
            return num-1;
        },
                    cardUsable:function(card,player,num){
            if(card.name=='sha') return num+1;
        },
                },
                trigger:{
                    player:"equipAfter",
                },
                forced:true,
                equipSkill:true,
                filter:function(event,player){
        return event.card.name=='paohuozb';
    },
                content:function(){
        player.loseHp();
    },
                intro:{
                    content:function(){
            return get.translation(skill);
        },
                },
            },
            fupaozu:{
                enable:"phaseUse",
                usable:1,
                complexCard:true,
                selectCard:[2,5],
                filterTarget:function(card,player,target){  if( target!=player&&player.inRange(target))return true;    },
                filter:function(event,player){
        return !player.countCards('h','sha')||!player.canUse('sha',player);
    },
                filterCard:function(card,player){
        if(ui.selected.cards.length){
            return get.suit(card)==get.suit(ui.selected.cards[0]);
        }
        var cards=player.getCards('he');
        for(var i=0;i<cards.length;i++){
            if(card!=cards[i]){
                if(get.suit(card)==get.suit(cards[i])) return true;
            }
        }
        return false;
    },
                check:function(card){  return 60-get.value(card);
    },
                prompt:"在没有杀或者不能出杀时，可弃置最多五张同花牌，耗n-2滴血，n为弃牌数,对你选择的目标视为出n-1个杀，<br>弃置达到（4，5）的杀拥有属性杀，极限4发，回复出杀次数会生效,技能结束后会获得袭击运输船技能",
                content:function(){//(if(event.num>2) player.useCard({name:'sha'},event.targets.randomGet());      player.chooseUseTarget({name:'sha'},false,'nodistance');event.num=event.cards.length;event.targets=player.getEnemies();
'step 0'
event.num=event.cards.length;
    player.addTempSkill('touxichuan','phaseAfter');var d=game.countPlayer(function(current){ return current!=player&&(get.attitude(player,current)<1)&&(current.hasSkill('bagua_skill')|current.hasSkill('re_bagua_skill'));  });
 game.log('有八卦的角色:',d,'弃置的手牌:',);
        player.chooseTarget(get.prompt2('选择攻击目标'),function(card,player,target){
            return target.maxHp>0&&player.inRange(target);
        }).set('ai',function(target){
            var att=-get.attitude(_status.event.player,target);
            if(target.hasSkill('zhanliebb')|target.hasSkill('hangmucv')){ att*=1.1};
    if(Math.ceil(target.hp*2)<=target.maxHp){ att*=1.3};if(target.countCards('h')<3){ att*=1.3};
    if(target.hasSkill('bagua_skill')|target.hasSkill('re_bagua_skill')){ att*=0.5};
             return att
        });
        'step 1'
        if(result.bool){
            var target=result.targets[0];
            event.target=target;
if(event.num>1) player.useCard({name:'sha'},event.target);
if(event.num>2) player.useCard({name:'sha'},event.target);
if(event.num>3) player.useCard({name:'sha',nature:'thunder',isCard:false},event.target);
if(event.num>4) player.useCard({name:'sha',nature:'fire',isCard:false},event.target);;
if(event.num>1) player.damage(event.num-2);}else event.finish;
  },
                ai:{
                    expose:0,
                    threaten:0.8,
                    order:4,
                    result:{
                        target:function(target,player){if(get.attitude(player,target)<0&&player.inRange(target)){
        if(player.countCards('he')>3){if(target.countCards('h')<4)return -2;return -1};return 0};
    },
                    },
                },
                intro:{
                    content:function(){
            return get.translation(skill);
        },
                },
            },
            zhuangjiafh:{
                trigger:{
                    player:["damageBefore","damageEnd"],
                },
                direct:true,
                firstDo:true,
                usable:6,
                filter:function(event,player){//要配合灵血回复护甲，与弃置护甲发起额外回合。if(trigger=="damageEnd")能啊，filter中的第三个参数，content中的event.triggername
        //
        return player.hujia==0
    },
                content:function(){//player.loseHp()player.hujia==0&&
        'step 0'
        game.log(event.triggername,!trigger.hujia);//trigger.name,
     //   if(event.triggername=='damageBefore'&&!player.countCards('h',{color:'red'})&&!trigger.hujia&&event.nature!="thunder"&&(player.hp>trigger.num)){player.changeHujia(2);player.loseHp();};
        if(event.triggername=='damageEnd'&&!player.countCards('h',{color:'red'})&&!trigger.hujia){player.changeHujia(1);};
        if(player.countCards('h',{color:'red'})){
        var next=player.chooseToDiscard('h',{color:'red'},get.prompt('叠甲'),('受伤时,若护甲值没有变化，则你可以在受伤前或受伤后，弃置一张红色手牌，获得1点护甲。<br>锁定：若没有红色手牌可以弃置，会在伤害结算后加1点护甲。<br>拥有此技能，则ai不会用护盾防御雷伤,也不会在雷杀面前加护甲'));
        next.ai=function(card){var player=_status.event.player;
         if(player.countCards({name:'tao'})&&player.hasSkill('lingxue'))return -1;
         if(event.triggername=='damageBefore'&&event.nature=="thunder")return-1;
         return 8-get.value(card);
        };
        next.logSkill='zhuangjiafh'};
        'step 1'
        if(result.bool){
            player.changeHujia();
        }
    },
                ai:{
                    nohujia:true,
                    "maixie_hp":true,
                    skillTagFilter:function(event){//player.countCards('he',{color:'red'})&&player.hp>1
            return event.nature=="thunder";
        },
                },
            },
            hangmucv:{
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            yuanhang:{
                group:["yuanhang_mopai","yuanhang_bingsimopai","yuanhang_dietogain","tiaozhanzhuanbei"],
                mod:{
                    attackFrom:function(from,to,distance){//打人的距离但主要是sha的攻击范围，应该是武器常用的mod技能
        //装备牌外接了一个技能(group('zhangba_skill'))额外进行技能效果//潜艇减少一点武器攻击距离加一点全局距离(这样实现锦囊全场递)，
       //驱逐对潜艇加1点武器距离。这是控制各舰船加成与摸牌的地方，可能会让游戏较卡，不过卡不过特效就是了。
       //大船受伤加攻击次数手牌上限，小船默认上限，受伤加攻击次数，所有船血量损失过半加一攻击距离。
        var a=0;if(from.hasSkill('qianting')){var a=a+1};if(from.hasSkill('quzhudd')&&to.hasSkill('qianting')){var a=a-1};
       if(from.hp*2<=from.maxHp){var a=a-1};return distance=(distance+a)},
                    maxHandcard:function(player,num){var a=0;if(player.hasSkill('junfu')|player.hasSkill('qianting')){var a=a+3};if(player.hasSkill('qingxuncl')|player.hasSkill('quzhudd')|player.hasSkill('daoqu')){ a+=(2)};
       if((player.hasSkill('zhongxunca')|player.hasSkill('zhanliebb')|player.hasSkill('hangmucv'))&&(player.hp<player.maxHp)){ a+=(1)};
         return num=(num+a);},
                    cardUsable:function(card,player,num){////是卡片作用时可选的目标数量，输出range给牌的发起事件阶段用。
       if(card.name=='sha') return num=(num+(player.hp*2<player.maxHp))},
                    globalFrom:function(from,to,distance){
var a=0;if(from.hasSkill('qianting')){var a=a-1};return distance=(distance+a);},
                    globalTo:function(from,to,distance){
var a=0;if(to.hasSkill('qianting')){var a=1};return distance=(distance+a);},
                },
                trigger:{
                    global:"phaseBefore",
                    player:"enterGame",
                },
                forced:true,
                filter:function(event,player){//怕主公第一轮去世加点buff，
        return (event.name!='phase'||game.phaseNumber==0);
    },
                content:function(){//player.addSkill('qianghuazhuang');global:"phaseBefore",
        if(player.identity=='zhu'){//player.addSkill('jijiang');player.addSkill('hujia');player.addSkill('jiuyuan');
 player.changeHujia(1);trigger.player.loseHp(1);player.discoverCard(get.inpile('basic'))};if(player.hasSkill('daoqu')){player.discoverCard(get.inpile('equip'))};
     //   group:["yuanhangmopai","huihejieshu","jianzaochuan","xshuangren","kaifa","diewulimitai","wulidebuff","qianghuachuan"],
    player.addSkill('')
    },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
                subSkill:{
                    mopai:{
                        trigger:{
                            player:"loseAfter",
                            global:["equipAfter","addJudgeAfter","gainAfter","loseAsyncAfter","addToExpansionAfter"],
                        },
                        frequent:true,
                        filter:function(event,player){
    //角色于失去牌阶段后，经历全局阶段“装备装备后，加入判定牌后，失去牌后，用牌响应事件”后，执行content
    //sd没错，无名杀是阶段+事件驱动游戏，没有攻击和摸牌数值，大多数操作会先经历事件或者阶段再来实现。同时各个部分就像技能一样
    //各种阶段的名字找教程，具体思路用游戏内搜索器搜，复制粘贴即可。
    //防止仁德给牌移除了给牌阶段后。为了平衡用usable限制。建议触发条件按手牌上限算，不然不是强如曹金玉就是弱如陆逊。
        var d=(player.getHandcardLimit()/2),a=0;if(player==_status.currentPhase){a+=(1)};
        if(player.countCards('h')>d) return false;
        var evt=event.getl(player);
     //  if((player.countMark('yuanhang_mopai'))>=(player.countMark('houqingup')+a)) return false;
                if(player.countMark('yuanhang_mopai')<=0)return false;
        return evt&&evt.player==player&&evt.hs&&evt.hs.length>0;
        //当手牌小于上线一半或者是准备阶段就执行，frequent自动执行，也可以force锁定强制执行。都没有要写check，事件内的选项要set.'ai'。
    },
                        content:function(){//最好是draw摸牌而不是增加事件阶段，事件会被跳过一个兵粮就没法玩。player.markSkill不太行
     //不过想玩张辽技能的话，trigger改为玩家摸牌开始2，comtent加入trigger.num++，
    //这将增加摸牌2的回合数来实现增加摸牌。用addmark，countMark存储变量稳定但是他们需要清除。var a=player.简便
    //player.drawTo(num)补牌至x，可以里面来个math.min(3,player.maxHp)做平衡。filter里的运算也可以搬过来。
    //if引导多个事件触发推荐用大括号括一下，else为否则，与if连起来就可以使用了，别加;哦。下面的ai复制粘贴的，
    //ai：expose被发现的数值，积累至1以上被ai发现身份。threaten被打的权重，理解是威胁度、嘲讽能力。有了技能回合计数函数就不用记录标记了,原来的摸牌不像连营，像无中生有。
    //if(player.hasMark('yuanhangmopai')||(player.countMark('mopaiup')<1)){ player.draw(1)}
    //else {player.draw(1+player.countMark('mopaiup'));player.addMark('yuanhangmopai')};
 //   player.draw(1);game.log((get.skillCount('yuanhang_mopai'))>=(player.countMark('mopaiup')+1),get.skillCount('yuanhang_mopai'),(player.countMark('mopaiup')+1),player.hasSkill('yuanhang_mopai'));
                player.draw(1);player.removeMark('yuanhang_mopai');
    },
                        intro:{
                            marktext:"摸牌",
                            content:function(player,mark){;var a=game.me.countMark('yuanhang_mopai');
            return '手牌较少时，失去手牌可以摸一张牌，还可以摸'+a+'次';
        },
                        },
                        sub:true,
                    },
                    dietogain:{
                        trigger:{
                            player:["dieAfter"],
                        },
                        direct:true,
                        forceDie:true,
                        filter:function(event,player){
        if(event.name=='die') return true;
        return player.isAlive();
    },
                        content:function(){
        'step 0'
        event.count=trigger.num||1;
        'step 1'
        event.count--;
        player.chooseTarget(get.prompt2('在离开战斗前，你还可以令队友、关注的对象摸x+1张牌，或许会有转机出现(x为你体力上限,保底给目标3张)<br>如果目标是伤害来源则摸x-1张牌，保底摸一张牌'),function(card,player,target){
            return target.maxHp>0;
        }).set('ai',function(target){
            var att=get.attitude(_status.event.player,target);
            var draw=Math.max(3,player.maxHp+1);
            if(target==trigger.source) att*=0.35;
            if(target.hasSkill('zhanliebb')) att*=1.05;
                return att
        });//让优势方有一轮的挑战，因为第二轮对手就因为过牌量下降而失去威胁。
        'step 2'
        if(result.bool){
            var target=result.targets[0];
            event.target=target;
            player.logSkill('yuanhang_dietogain',target);
            if(target==trigger.source){target.draw(Math.max(1,player.maxHp-1))}else
            target.draw(Math.max(3,player.maxHp+1));
        }
        else event.finish();
    },
                        sub:true,
                    },
                    bingsimopai:{
                        trigger:{
                            player:"dying",
                        },
                        name:"濒死摸牌",
                        "prompt2":function(event,player){
   if((player.hasMark('yuanhang_bingsimopai'))) {return '每当你进入濒死状态时，你可以摸两张牌,若血量上限大于2，你需失去一点体力上限。没有被 刚烈 与 镇卫 折磨吧'};
 if((!player.hasMark('yuanhang_bingsimopai'))) {return '每当你进入濒死状态时，你可以摸两张牌,若血量上限大于2，你需失去一点体力上限。同时，依据舰种获得以下技能：<br>潜艇-断粮（徐晃）、刚烈（夏侯惇）；驱逐-镇卫（文聘）、同疾（袁术）；<br>轻巡-丈八蛇矛技能；重巡-刚烈改（改自夏侯惇）；<br>战列-刚烈改（夏侯惇)；航母-界连营（陆逊）；军辅：青囊（华佗）；导驱-界连营（陆逊）'}; },
                        usable:2,
                        fixed:true,
                        content:function(){//兵粮寸断与据守，刚烈，     镇卫同疾吸伤害，国风防锦囊牌。
        //轻巡提升己方防守与攻击距离，粮策全体发牌。  重巡提供免伤。战列刚烈反击。 
        player.draw(1);if(player.maxHp>2){player.loseMaxHp(1);player.draw();player.logSkill('kurou',player);}else game.playAudio('..','extension','舰R牌将/audio','bingsimosanpai');if(player.maxHp>5){player.loseMaxHp(1);player.draw();game.log('怕血量上限太高而导致濒死摸牌的体验不佳，额外来一次扣血摸牌',player);}
     if(!player.hasMark('yuanhang_bingsimopai')){
    if(player.hasSkill('qianting')){player.addSkill('gzduanliang','ganglie')};
    if(player.hasSkill('quzhudd')){player.addSkill('hzhenwei','retongji')};
    if(player.hasSkill('qingxuncl')){player.addSkill('zhangba_skill')};
    if(player.hasSkill('zhongxunca')){player.addSkill('ganglie_gai')};
    if(player.hasSkill('zhanliebb')){player.addSkill('ganglie_gai')};
    if(player.hasSkill('hangmucv')){player.addSkill('relianying')};
   if(player.hasSkill('junfu')){player.addSkill('qingnang')};      
   if(player.hasSkill('daoqu')){player.addSkill('relianying')};   
  }; trigger.player.addMark('yuanhang_bingsimopai',1); },
                        intro:{
                            mark:false,
                            content:function(){
        return get.translation(skill+'_info');},
                        },
                        sub:true,
                    },
                },
            },
            qianting:{
                mod:{
                    selectTarget:function(card,player,range){
            if(range[1]==-1) return;
            if(get.color(card)=='black'&&get.type(card)=='trick'){
                var info=get.info(card);
                if(info.multitarget) return false;
                range[1]+=player.countMark('jinengup');
            }
        },
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            zhanliebb:{
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            qingxuncl:{
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            zhongxunca:{
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            misscoversha:{
                trigger:{
                    player:"shaMiss",
                },
                silent:true,
                filter:function(event){//return event.getParent(2).name=='fupaozu'
        ;
    },
                content:function(){
    player.getStat().card.sha--
    },
                forced:true,
                popup:false,
                ai:{
                    expose:0.3,
                    threaten:8.8,
                    order:5,
                    result:{
                        player:1,
                    },
                },
            },
            roundonefire:{
                audio:"ext:1牌将修改:2",
                trigger:{
                    global:"roundStart",
                },
                lastDo:true,
                "prompt2":function(event,player){event.targets=player.getEnemies();
   var  xiaohao=Math.floor(Math.min(2,event.targets.length/2+0.5));
   var d=game.countPlayer(function(current){return current!=player&&event.targets.contains(current)&&!current.hasSkill('bagua_skill')&&!current.hasSkill('re_bagua_skill')&&!current.hasSkill('tengjia1');});
  var c=game.countPlayer(function(current){return current!=player&&event.targets.contains(current)&&(current.hasSkill('rw_renwang_skill')||current.hasSkill('re_bagua_skill')||current.hasSkill('tengjia1'));});
   if(player.hasSkill('hangmucv')) {return '一轮游戏开始时选择发动，你随机弃置'+xiaohao+'张牌，视为对非友方角色使用万箭齐发，<br>以'+xiaohao+'张牌换'+d+'的收益，同时不必考虑队友状态的技能，但是用完后容易去世'};
   if(player.hasSkill('daoqu')) {return '一轮游戏开始时选择发动，你随机弃置一张牌，视为用火杀攻击一名你选择的敌人'};
 if(player.hasSkill('qianting')) {return '一轮游戏开始时选择发动，你随机弃置一张牌，视为用雷杀攻击一名你选择的敌人<br>有'+c+'个目标的防具无法防御虚拟杀和雷杀的组合攻击'};  },
                filter:function(event,player){//意外发现function应用广泛，然而解决不了自动显示隐藏标记。航母开幕，然后根据舰种判断具体出什么杀
    return player.countCards('h')>0;},
                content:function(){//若你仍有手牌，会再弃置一张手牌，视为对你选择的敌人使用冰杀。没有手牌会结束此技能。能加快战局推进。，视为用雷杀攻击你选择的敌人，没有手牌会结束此技能。能加快战局推进。,然后再弃置一张牌使用火杀。没有手牌会结束此技能。能加快战局推进。
        'step 0'
event.targets=player.getEnemies();game.playAudio('..','extension','舰R牌将/audio',player.name);
        'step 1'
var e1=player.countCards('e','hangkongzhan'),xiaohao=Math.floor(Math.min(2,event.targets.length/2+0.5));
if(player.countCards('h')>=1&&(player.hasSkill('hangmucv')||e1>0)){if(player.countCards('h')>=2&&xiaohao>=2){player.discard(player.getCards('h').randomGet());};player.discard(player.getCards('h').randomGet());player.useCard({name:'jinjuzy'},event.targets)};                  //wanjian,jinjuzy                                                 
'step 2'
if(player.hasSkill('qianting')){player.chooseTarget(get.prompt2('选择杀的目标'),function(card,player,target){
            return target.maxHp>0&&player.inRange(target);
        }).set('ai',function(target){
            var att=-get.attitude(_status.event.player,target);
            if(target.hasSkill('zhanliebb')|target.hasSkill('zhanliebb')){ att*=1.5};
    if(Math.ceil(target.hp*2)<=target.maxHp){ att*=2};
    if(target.hasSkill('bagua_skill')|target.hasSkill('re_bagua_skill')){ att*=0.5};
             return att
        });}else event.finish;
        'step 3'
        if(result.bool){
            var target=result.targets[0];
            event.target=target;
//if(player.countCards('h')>0){player.discard(player.getCards('h').randomGet())&&player.useCard({name:'sha',nature:'thunder',isCard:true},event.target);};
if(player.countCards('h')>0&&player.hasSkill('qianting')){player.discard(player.getCards('h').randomGet()),player.useCard({name:'sha',nature:'thunder',isCard:true},event.target);}
//if(player.countCards('h')>0&&player.hasSkill('daoqu')){player.discard(player.getCards('h').randomGet()),player.useCard({name:'sha',nature:'fire',isCard:true},event.target);}
        }else event.finish;




        
    },
                ai:{
                    basic:{
                        order:10,
                    },
                    result:{
                        player:1,
                    },
                },
            },
            xianjinld:{
                global:"xianjinld_difend",
                trigger:{
                    global:"phaseDrawBegin",
                },
                frequent:function(event,player){if(get.attitude(player,event.player)>0) return true;return false},
                check:function(event,player){if(get.attitude(player,event.player)<0) return false;return true},
                logTarget:"player",
                filter:function(event,player){//spshicai与云将技能在下面，除了帮助队友外还可以看牌顶。
        return (get.attitude(player,event.player)>=0||player.identity=='nei')&&get.distance(player,event.player,'pure')<=1+player.countMark('jinengup');
    },
                "prompt2":function(event,player){var a=get.translation('xianjinld_info');
   if(player.identity=='nei') {a+=('<br>内奸需要辅助弱势方，攻击实力出色的角色，平衡场上局势，保持自己的状态，伺机实现连破。')};
    return a;
    },
                content:function(){if(trigger.player!=player){trigger.num++};if(trigger.player==player){trigger.num-=(2);player.discoverCard(get.inpile('basic'));}; },
                mod:{
                    aiOrder:function(player,card,num){
if(get.itemtype(card)=='card'&&card.hasGaintag('xianjinld')) return num+3;
},
                },
                onremove:function(player){
player.removeGaintag('xianjinld');
},
                mark:true,
                intro:{
                    mark:function(dialog,content,player){
if(!get.attitude(game.me,player)>0) return get.translation(player)+'观看牌堆中...'+'<br>增益。所有队友：武器攻击距离+1，实际距离此角色为'+(1+player.countMark('songpaiup'))+'的队友：摸牌阶段多摸一张牌';
if(get.itemtype(_status.pileTop)!='card') return '牌堆顶无牌';var cardPile=Array.from(ui.cardPile.childNodes);var cardPile=cardPile.slice(0,Math.min(3,cardPile.length));dialog.addAuto(cardPile);
//dialog.add([_status.pileTop]);
},
                },
                subSkill:{
                    difend:{
                        mod:{
                            globalFrom:function(from,to,num){
            return num-game.countPlayer(function(current){
                return current!=from&&get.attitude(from,current)>0&&current.hasSkill('xianjinld');
            });
        },
                        },
                        sub:true,
                    },
                },
            },
            "rendeonly2":{
                audio:"ext:舰R牌将:2",
                audioname:["gz_jun_liubei","shen_caopi"],
                enable:"phaseUse",
                filterCard:true,
                position:"he",
                selectCard:[1,2],
                discard:false,
                usable:2,
                lose:false,
                delay:false,
                filterTarget:function(card,player,target){
        if(player.storage.rerende2&&player.storage.rerende2.contains(target)&&get.distance(player,target,'pure')<=1+player.countMark('shoupaiup')) return false;
        return player!=target;
    },
                onremove:["rerende","rerende2"],
                check:function(card){
        if(ui.selected.cards.length&&ui.selected.cards[0].name=='du') return 0;
        if(!ui.selected.cards.length&&card.name=='du') return 20;
        var player=get.owner(card);
        if(ui.selected.cards.length>=Math.max(2,player.countCards('h')-player.hp)) return 0;
        if(player.hp==player.maxHp||player.storage.rerende<0||player.countCards('h')<=1){
            var players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(players[i].hasSkill('haoshi')&&
                    !players[i].isTurnedOver()&&
                    !players[i].hasJudge('lebu')&&
                    get.attitude(player,players[i])>=3&&
                    get.attitude(players[i],player)>=3){
                    return 11-get.value(card);
                }
            }
            if(player.countCards('h')>player.hp) return 10-get.value(card);
            if(player.countCards('h')>2) return 6-get.value(card);
            return -1;
        }
        return 10-get.value(card);
    },
                content:function(){
        'step 0'
        var evt=_status.event.getParent('phaseUse');
        if(evt&&evt.name=='phaseUse'&&!evt.rerende){
            var next=game.createEvent('rerende_clear');
            _status.event.next.remove(next);
            evt.after.push(next);
            evt.rerende=true;
            next.player=player;
            next.setContent(lib.skill.rerende1.content);
        }
        if(!Array.isArray(player.storage.rerende2)){
            player.storage.rerende2=[];
        }
        player.storage.rerende2.push(target);
        target.gain(cards,player,'giveAuto');//var usecard=cards[0];target.chooseUseTarget(usecard);
        for(var i=0;i<cards.length;i+=(1)){var usecard=cards[i];if(usecard.name!='sha'||!target.hasSkill('diewulimitai_shale')){target.chooseUseTarget(usecard)};if(usecard.name=='sha'){target.addSkill('diewulimitai_shale');};};
        if(typeof player.storage.rerende!='number'){
            player.storage.rerende=0;
        }
        if(player.storage.rerende>=0){
            player.storage.rerende+=cards.length;
            if(player.storage.rerende>=2){
                var list=[];
                if(lib.filter.cardUsable({name:'sha'},player,event.getParent('chooseToUse'))&&game.hasPlayer(function(current){
                    return player.canUse('sha',current);
                })){
                    list.push(['基本','','sha']);
                }
                for(var i of lib.inpile_nature){
                 if(lib.filter.cardUsable({name:'sha',nature:i},player,event.getParent('chooseToUse'))&&game.hasPlayer(function(current){
                            return player.canUse({name:'sha',nature:i},current);
                        })){
                        list.push(['基本','','sha',i]);
                    }
                }
          //      if(lib.filter.cardUsable({name:'tao'},player,event.getParent('chooseToUse'))&&game.hasPlayer(function(current){
      //              return player.canUse('tao',current);
           //     })){
        //            list.push(['基本','','tao']);
      //          }
                if(lib.filter.cardUsable({name:'jiu'},player,event.getParent('chooseToUse'))&&game.hasPlayer(function(current){
                    return player.canUse('jiu',current);
                })){
                    list.push(['基本','','jiu']);
                }
                if(list.length){
                    player.chooseButton(['是否视为使用一张基本牌？',[list,'vcard']]).set('ai',function(button){
                        var player=_status.event.player;
                        var card={name:button.link[2],nature:button.link[3]};
                        if(card.name=='tao'){
                            if(player.hp==1||(player.hp==2&&!player.hasShan())||player.needsToDiscard()){
                                return 5;
                            }
                            return 1;
                        }
                        if(card.name=='sha'){
                            if(game.hasPlayer(function(current){
                                return player.canUse(card,current)&&get.effect(current,card,player,player)>0
                            })){
                                if(card.nature=='fire') return 2.95;
                                if(card.nature=='thunder'||card.nature=='ice') return 2.92;
                                return 2.9;
                            }
                            return 0;
                        }
                        if(card.name=='jiu'){
                            return 0.5;
                        }
                        return 0;
                    });
                }
                else{
                    event.finish();
                }
                player.storage.rerende=-1;
            }
            else{
                event.finish();
            }
        }
        else{
            event.finish();
        }
        'step 1'
        if(result&&result.bool&&result.links[0]){
            var card={name:result.links[0][2],nature:result.links[0][3]};
            player.chooseUseTarget(card,true);
        }
    },
                ai:{
                    fireAttack:true,
                    order:function(skill,player){
            if(player.hp<player.maxHp&&player.storage.rerende<2&&player.countCards('h')>1){
                return 7;
            }
            return 3;
        },
                    result:{
                        target:function(player,target){
                if(target.hasSkillTag('nogain')) return 0;
                if(ui.selected.cards.length&&ui.selected.cards[0].name=='du'){
                    if(target.hasSkillTag('nodu')) return 0;
                    return -10;
                }
                if(target.hasJudge('lebu')) return 0;
                var nh=target.countCards('h');
                var np=player.countCards('h');
                if(player.hp==player.maxHp||player.storage.rerende<0||player.countCards('h')<=1){
                    if(nh>=np-1&&np<=player.hp&&!target.hasSkill('haoshi')) return 0;
                }
                return Math.max(1,5-nh);
            },
                    },
                    effect:{
                        target:function(card,player,target){
                if(player==target&&get.type(card)=='equip'){
                    if(player.countCards('e',{subtype:get.subtype(card)})<2){
                        if(game.hasPlayer(function(current){
                            return current!=player&&get.attitude(player,current)>0;
                        })){
                            return 0;
                        }
                    }
                }
            },
                    },
                    threaten:0.8,
                },
            },
            diewulimitai:{
                enable:"phaseUse",
                filterCard:function(card){var player=_status.event.player;
   //if(player.hasMark('diewulimitai_2_shale')){return get.type(card)=='equip';}else
        return  card.name=='sha'||card.name=='jiu'||get.type(card)=='equip';
        
    },
                filterTarget:function(card,player,target){
      if((get.attitude(player,target)>=0||player.identity=='nei'))  return target!=player&&get.distance(player,target,'pure')<=1+player.countMark('shoupaiup');
    },
                usable:2,
                position:"he",
                prompt:function(){return "给队友一张杀或装备牌，一回合限2次。<br>不准两次递杀，对主公不友好"},
                prepare:"give",
                discard:false,
                content:function(){//group:["diewulimitai_2"],
        target.gain(cards,player);
        for(var i=0;i<cards.length;i+=(1)){var usecard=cards[i];if(usecard.name!='sha'||!target.hasSkill('diewulimitai_shale')){target.chooseUseTarget(usecard);}};
        if(!target.hasSkill('diewulimitai_shale')){
           //player.draw();
            target.addSkill('diewulimitai_shale');
        }
    },
                subSkill:{
                    shale:{
                        trigger:{
                            player:"phaseJieshuBegin",
                        },
                        fixed:true,
                        silent:true,
                        friquent:true,
                        content:function(){//,player.countMark('diewulimitai_2_shale')
     if(player.hasSkill('diewulimitai_2_shale')){player.removeSkill('diewulimitai_2_shale');};
    },
                        intro:{
                            marktext:"给了杀",
                            content:function(player){
            return ('一个标记，应用了subSkill而想设置这段话');
        },
                        },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
                ai:{
                    order:function(skill,player){
            if(player.countCards('h','nanman')>0&&player.countCards('he','zhuge')<1){
                return 10;
            }
            return 1;
         },
                    expose:0,
                    result:{
                        target:function(player,target){if(!player.canUse('sha',player)&&player.countCards('h','sha')>1&&get.attitude(player,target)>=0&&get.distance(player,target,'pure')<=1+player.countMark('shoupaiup'))　{var e1=target.get('e','1');
　　if(e1){
　　if((e1.name=='zhuge')||(e1.name=='rewrite_zhuge')) return 1.1;};
   if((target.hasSkill('qigong')||target.hasSkill('guanshi_skill')))  return 1;};return 0;
            },
                    },
                },
            },
            foundtrick:{
                trigger:{
                    source:"damageBegin",
                },
                forced:true,
                usable:1,
                filter:function(event){
        return event.card&&get.type(event.card)=='trick'&&event.parent.name!='_lianhuan'&&event.parent.name!='_lianhuan2';
    },
                content:function(){game.log('要锦囊牌加伤了');
        trigger.num+=(player.hasMark('jianzaochuan'));
    },
                group:["foundtrick_discover","foundtrick_draw"],
                ai:{
                    threaten:0,
                },
                subSkill:{
                    discover:{
                        trigger:{
                            player:"phaseUseBegin",
                        },
                        forced:true,
                        lastDo:true,
                        content:function(){game.log('要摸锦囊牌了');
event.tishi='技能名为魔王的技能，锦囊牌伤害加1（如果已经改造完成）。<br>出牌阶段开始时，你发现一张锦囊牌，然后弃置一张牌。'  ;player.discoverCard(get.inpile('trick'));
        if(player.countCards('he')>=0)    {player.chooseToDiscard(1,true).set('prompt2',event.tishi).set('ai',function(card){
          　if(ui.selected.cards.length) return -1;
            if(card.name=='tao') return -10;
            if(card.name=='jiu'&&_status.event.player.hp==1) return -10;
            return get.unuseful(card)+2.5*(5-get.owner(card).hp);
        });}
            },
                        sub:true,
                    },
                    draw:{
                        trigger:{
                            player:"phaseDrawBegin",
                        },
                        content:function(){//game.log('要少摸牌了')
              //trigger.num+=(-1);
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
            },
            kanpolimitai:{
                enable:"chooseToUse",
                locked:false,
                usable:1,
                filterCard:function(card){
        return get.color(card)=='black';
    },
                viewAsFilter:function(player){
        return player.countCards('hs',{color:'black'})>0;
    },
                viewAs:{
                    name:"wuxie",
                },
                position:"hs",
                prompt:"将一张黑色手牌当无懈可击使用",
                check:function(card){
        var tri=_status.event.getTrigger();
        if(tri&&tri.card&&tri.card.name=='chiling') return -1;
        return 8-get.value(card)
    },
                threaten:1.2,
                ai:{
                    basic:{
                        useful:[6,4,3],
                        value:[6,4,3],
                    },
                    result:{
                        player:1,
                    },
                    expose:0.2,
                },
            },
            wa:{
                group:["fangkoganning_kengdiezhudongji"],
                audio:"ext:舰R牌将:1",
                audioname:["yixian","sunce","re_sunben","re_sunce","ol_sunjian"],
                unique:true,
                nodelay:true,
                enable:["chooseToRespond"],
                position:"he",
                filterCard:true,
                init:function(player){//初始化数组，也可以运行事件再加if后面的内容"chooseToUse",
    if(!player.storage.fangkoganning) player.storage.fangkoganning=[0,0,0,0];
    },
                selectCard:function(){
        var player=_status.event.player;
        return [1,player.countCards('h')];
    },
                check:function(card){var player=get.owner(card); 
    // var att=get.effect(target,player.storage.fangkoganning[1],player.storage.fangkoganning[2],player); 
     if(game.phaseNumber<2) return -1;
     if(ui.selected.cards.length>=Math.max(player.countCards('h')/3,1)) return -1;
      return (player.maxHp/player.hp+player.countCards('h')-ui.selected.cards.length)*2-get.value(card)+2;
    },
                filterTarget:function(card,player,target){
        return !target.hasSkill('fangkoganning_aibiexuan')&&player.storage.fangkoganning[0].contains(target)&&get.attitude(player,target)<0;
    },
                filter:function(event,player){
       if(player.storage.fangkoganning[3]==1)return true;
    //    if(event.name=='fangkoganning_kengdiezhudongji') return true;;&&event.name=="fangkoganning_kengdiezhudongji"&&event.name=='fangkoganning'
 return false;   },
                selectTarget:function(){
        return ui.selected.cards.length;
    },
                complexSelect:true,
                content:function(){
    "step 0"
    player.update();player.storage.fangkoganning[3]=target.length;
    "step 1"
     //   trigger.getParent().excluded.addArray(event.target);player.logSkill('fangkoganning',event.target);
   target.addSkill('fangkoganning_aibiexuan');   game.log(event.name=="fangkoganning",get.effect(target,player.storage.fangkoganning[1],player.storage.fangkoganning[2],player),target,get.effect(player,player.storage.fangkoganning[1],player,player),player,get.attitude(player,target)
              );event.finish;
              
    },
                ai:{
                    order:6.9,
                    respondSha:true,
                    respondShan:true,
                    skillTagFilter:function(event,player){//player.countCards('he',{color:'red'})&&player.hp>1
            //function(player,target){
           //var att=get.effect(target,player.storage.fangkoganning[1],player.storage.fangkoganning[2],player); //game.log(game.phaseNumber,game.players.length*2,trigger.targets.length,game.players.length-1,trigger.excluded.contains(target)))if(att>0&&get.attitude(player,target)<0){};  if(att<0&&get.attitude(player,target)>0){return att+0.1};*get.attitude(player,target);player:function(player,target){return get.effect(player,player.storage.fangkoganning[1],player.storage.fangkoganning[2],_status.event.player); },
           //if(att<0)return 10000;},
     var player=_status.event.player;       return event.name=="fangkoganning";},
                    ai:{
                        basic:{
                            useful:[6,4,3],
                            value:[6,4,3],
                        },
                        result:{
                            player:1,
                        },
                        expose:0.2,
                    },
                },
                subSkill:{
                    aibiexuan:{
                        trigger:{
                            global:"useCardToPlayered",
                        },
                        forced:true,
                        lastDo:true,
                        content:function(){
                                        
                    trigger.targets.remove(player);
                    trigger.getParent().triggeredTargets2.remove(player);
                    trigger.getParent().triggeredTargets3.remove(player);
                    trigger.untrigger();player.removeSkill('fangkoganning_aibiexuan');game.log('保护结束');
            },
                        sub:true,
                    },
                    kengdiezhudongji:{
                        trigger:{
                            global:"useCardToPlayered",
                        },
                        forced:true,
                        filter:function(event,player){
        if(event.getParent().triggeredTargets3.length>1) return false;
        if(get.type(event.card)!='trick') return false;
        if(get.info(event.card).multitarget) return false;
        if(event.targets.length<2&&!get.attitude(player,event.target)>=0) return false;
    //    if(player.storage.fangkoganning) return false;
        return true;
    },
                        firstDo:true,
                        content:function(){
                "step 0" //game.log(trigger.targets);
//game.log(game.phaseNumber,game.players.length*2,trigger.targets.length,game.players.length-1,_status.event.getTrigger(),trigger.excluded.contains(target));         .set('ai',function(card){if(card.name=='sha')return -1;});get.translation('fangkoganning_info')+
    player.storage.fangkoganning=[trigger.targets,trigger.card,trigger.player,1];//game.log(player.storage.fangkoganning);//player.storage.fangkoganning1=trigger.card;player.storage.fangkoganning2=trigger.player;player.storage.fangkoganning3=[];
        player.chooseToRespond({name:'sha'}).set('prompt2','<br>点击防空，使用主动技能保护团队，<br>也可以用这个响应用杀先发制人，用火杀打残对手？<br>这个响应的效果……实属无奈而制作的，');
                "step 1"
if(result.bool==true){
if(player.storage.fangkoganning[3]==0)player.chooseUseTarget({name:'sha'});
}else player.storage.fangkoganning[3]=0;},
                        sub:true,
                    },
                },
            },
            kaifa:{
                position:"he",
                audio:"xinfu_jingxie",
                enable:"phaseUse",
                filter:function(event,player){//group:["xinfu_jingxie2"],
        var he=player.getCards('he');
        for(var i=0;i<he.length;i++){
            if(["bagua","baiyin","lanyinjia","renwang","tengjia","zhuge"].contains(he[i].name)) return true;
        }
        return false;
    },
                filterCard:function(card){
        return ["bagua","baiyin","lanyinjia","renwang","tengjia","zhuge"].contains(card.name);
    },
                discard:false,
                lose:false,
                delay:false,
                check:function(){
        return 1;
    },
                content:function(){
        "step 0"
        player.showCards(cards);
        "step 1"
        var card=cards[0];
        var bool=(get.position(card)=='e');
        if(bool) player.removeEquipTrigger(card);
        game.addVideo('skill',player,['xinfu_jingxie',[bool,get.cardInfo(card)]])
        game.broadcastAll(function(card){
            card.init([card.suit,card.number,'rewrite_'+card.name]);
        },card);
        if(bool){
            var info=get.info(card);
            if(info.skills){
                for(var i=0;i<info.skills.length;i++){
                    player.addSkillTrigger(info.skills[i]);
                }
            }
        }
    },
                ai:{
                    basic:{
                        order:10,
                    },
                    result:{
                        player:1,
                    },
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
                "audioname2":{
                    "key_shiki":"shiki_omusubi",
                },
            },
            huijiahuihe:{
                trigger:{
                    player:"phaseEnd",
                },
                round:1,
                name:"回合",
                lastDo:true,
                filter:function(event,player){
        return player.hujia>0;
    },
                check:function(event,player){
        return player.hujia>0&&player.hp>0;
    },
                content:function(){
        player.storage.huijiahuihe=player.hujia;
        player.changeHujia(-player.hujia);
        player.insertPhase();
    },
                group:["huijiahuihe_hp","huijiahuihe_draw","huijiahuihe_roundcount"],
                subSkill:{
                    hp:{
                        trigger:{
                            player:"phaseAfter",
                        },
                        silent:true,
                        filter:function(event,player){
                return event.skill=='huijiahuihe'&&!player.getStat('damage');
            },
                        content:function(){game.log('没输出还是来抽张牌吧')
                player.draw();
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                    draw:{
                        trigger:{
                            player:"phaseDrawBegin",
                        },
                        filter:function(event){
                return event.getParent('phase').skill=='huijiahuihe';
            },
                        silent:true,
                        content:function(){game.log('要少摸牌了')
                trigger.num-=(2-player.storage.huijiahuihe);
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
            },
            touxichuan:{
                audio:"ext:舰R牌将:2",
                audioname:["re_ganning","re_heqi"],
                enable:"chooseToUse",
                ueable:2,
                filterCard:function(card,player){return get.color(card)=='red'},
                position:"hes",
                viewAs:{
                    name:"guohe",
                },
                viewAsFilter:function(player){//,{color:'red'}
        if(!player.countCards('hes')) return false;
    },
                check:function(card){return 6-get.value(card)},
                prompt:"每回合限三次，弃置一张手牌，弃置对手一张手牌或者装备牌，并为对手施加进水debuff。",
                content:function(){
            player.logSkill('guohe',target);game.log('要进水弃牌了')
            target.addSkill('wulidebuff_jinshui');trigger.player.addMark('wulidebuff_jiansu',1);
},
                ai:{
                    basic:{
                        order:1,
                        useful:3,
                        value:3,
                    },
                    yingbian:function(card,player,targets,viewer){
            if(get.attitude(viewer,player)<=0) return 0;
            if(game.hasPlayer(function(current){
                return !targets.contains(current)&&lib.filter.targetEnabled2(card,player,current)&&get.effect(current,card,player,player)>0;
            })) return 6;
            return 0;
        },
                    result:{
                        target:function(player,target){
                var att=get.attitude(player,target);
                var nh=target.countCards('h');
                if(att>0){
                    if(target.countCards('j',function(card){
                        var cardj=card.viewAs?{name:card.viewAs}:card;
                        return get.effect(target,cardj,target,player)<0;
                    })>0) return 3;
                    if(target.getEquip('baiyin')&&target.isDamaged()&&
                        get.recoverEffect(target,player,player)>0){
                        if(target.hp==1&&!target.hujia) return 1.6;
                    }
                    if(target.countCards('e',function(card){
                        if(get.position(card)=='e') return get.value(card,target)<0;
                    })>0) return 1;
                }
                var es=target.getCards('e');
                var noe=(es.length==0||target.hasSkillTag('noe'));
                var noe2=(es.filter(function(esx){
                    return get.value(esx,target)>0;
                }).length==0);
                var noh=(nh==0||target.hasSkillTag('noh'));
                if(noh&&(noe||noe2)) return 0;
                if(att<=0&&!target.countCards('he')) return 1.5;
                return -1.5;
            },
                    },
                    tag:{
                        loseCard:1,
                        discard:1,
                    },
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            wulidebuff:{
                trigger:{
                    source:"damageBefore",
                },
                name:"属性效果",
                lastDo:true,
                forced:true,
                filter:function(event,player){//usable:1,
    //trigger…（什么人的什么阶段让技能拥有者触发技能，伤害damage阶段与使用一张卡牌usecard阶段是在阶段内计算结果的哦）
    //trigger里一般有player：…（有技能的到阶段就发）/target：…被对面瞄准后到阶段就放/source：…伤害来源有这个技能的到…阶段就放 
    //global进入一些特殊阶段会让有技能的触发此技能（配合player缩小触发范围，实现全回合技能使用者摸牌）这几种，
    //当是player:'阶段'时，可用trigger.player指技能拥有者（player），当是target:'阶段'时，trigger.target是技能拥有者
    //但trigger.player变为指定技能拥有者为目标的人，当source:'阶段'时，trigger.player是技能拥有者指定的目标
        if((event.nature&&player!=event.player)&&event.num>0)
    //只有在filter才可以判断卡牌目标、伤害的种类、受伤的人，在伤害发生后这些判断不能在content使用。source、target也是
    //虽然不能在content使用source，但可以用全新的trigger.player表示被这个技能作用的人，player仍然指使用这个技能的人，
    //trigger.num仍然能指代阶段数，event.num仍然能代替abcd这些赋值的文字使用。game.log仍然能帮你查错。
    //trigger.num+=(1)是函数增伤的写法，num++是简写。player.hasSkillTag('jueqing',false,target)
    return true},
                content:function(){//火杀先增加伤害次数，再考虑其他，比如负面效果。log用了翻译代码把武将名切换为中文，trigger.player.damage(1,'fire');可以无线触发这个技能哦。
    //而且content里面event要变成trigger,如event.num变为trigger.num。代码玄学风
       var  link=(game.hasPlayer(function(current){return get.attitude(player,current)<0&&current==trigger.player&&current.isLinked();})-game.hasPlayer(function(current){return get.attitude(player,current)>0&&current==trigger.player&&current.isLinked();}));

   if(trigger.nature=='fire')  {//if(player.hasSkill('zhongxunca')&&trigger.player.hasMark('gaizhaoup')&&trigger.player.hasSkill('quzhudd')|trigger.player.hasSkill('qingxuncl')) {trigger.player.damage(1);game.log('重巡克制改造驱逐、巡洋伤害:',1);};if(player.hasSkill('qingxuncl')&&trigger.player.hasMark('gaizhaoup')&&trigger.player.hasSkill('zhanliebb')) {trigger.player.damage(1);game.log('轻巡克制战列舰（很难的啦）:',1);}
      {trigger.player.addSkill('wulidebuff_ranshao');trigger.player.addMark('wulidebuff_ranshao',1);
     game.log(get.translation(player.name)+'<span class=firetext>燃烧</span>'+get.translation(trigger.player.name)+'<span class=thundertext>,ta还能坚持到出完牌');};
     if(trigger.player.hp*2<trigger.player.maxHp){player.$throwEmotion(trigger.player,'yanhua')};  
        game.playAudio('..','extension','舰R牌将/audio','wulidebuff');};     
        
     if(trigger.nature=='thunder'){if(player.hasSkill('hanbing_gai'))  {trigger.player.addSkill('wulidebuff_jinshui');trigger.player.addMark('wulidebuff_jinshui');//trigger.num+=(player.countMark('atkup'));hanbing_gai
   //if(player.hasSkill('zhanliebb')&&trigger.player.hasMark('gaizhaoup')&&trigger.player.hasSkill('zhongxunca')){trigger.player.damage(player.countMark('atkup'));game.log('改造重巡被击穿'+1)} ;
    if(trigger.player.hujia>0) {trigger.num+=(1) ;game.log('对护甲加伤'+1)};
    game.log(get.translation(player.name)+'让:'+get.translation(trigger.player.name)+'进水减手牌上限了') ; if(trigger.player.hp*2<trigger.player.maxHp){player.$throwEmotion(trigger.player,'wine')}; };            
        
       if(!player.hasSkill('hanbing_gai')){ //if((player.hasSkill('quzhudd')|player.hasSkill('qianting'))&&trigger.player.hasMark('gaizhaoup')&&(trigger.player.hasSkill('zhanliebb')|trigger.player.hasSkill('hangmucv'))){trigger.player.loseHp(1) ;game.log('鱼雷的穿透增伤:',1)};
   trigger.player.addSkill('wulidebuff_jiansu');trigger.player.addMark('wulidebuff_jiansu',1);//  trigger.num+=(player.countMark('atkup'));
 if((trigger.player.hujia>0||trigger.player.hasSkillTag('maixie_defend'))&&(!trigger.player.isLinked()||(trigger.player.isLinked()&&link<2||trigger.num<2))){ trigger.player.loseHp(trigger.num);game.log('雷杀穿透护甲:',trigger.num);trigger.num-=(trigger.num),trigger.cancel};
 game.log(get.translation(player.name)+'<span class=thundertext>减速了:</span>'+get.translation(trigger.player.name)+'小心随之而来的集火');
  if(trigger.player.hp*2<trigger.player.maxHp){player.$throwEmotion(trigger.player,'hehua')};  };  };      
     var target=trigger.player ;  var tishi='回合结束受到一点火焰伤害，摸一张牌，火杀带来的负面效果，本回合被攻击了'+trigger.player.countMark('wulidebuff_ranshao')+'次，';if(trigger.player.countMark('wulidebuff_ranshao')>0&&player.hp<=2){tishi+=('可能小命不保，求求队友给点力，发挥抽卡游戏的玄学力量。”')};if(trigger.player.countMark('wulidebuff_ranshao')>2&&trigger.player.hp<=2){tishi+=('“被集火了，希望队友能能继续扛起重任。')};if(trigger.player.identity=='nei'){tishi+=('为了自己的光辉岁月，我内奸一定能苟住，一定要苟住')};if(trigger.player.identity=='zhu'){tishi+=('我的生命在燃烧，')};if(trigger.player.identity=='zho'){tishi+=('同志，救我，我被火力压制了。')};if(trigger.player.identity=='fan'){tishi+=('就怕火攻一大片啊，我们的大好前程被火杀打到功亏一篑')};
        trigger.player.updateMarks();
        game.broadcastAll(function(player){var target=trigger.player
           if(!target._wulidebuff_ranshao_mark) return;
            target._wulidebuff_ranshao_mark.name='燃烧';
            target._wulidebuff_ranshao_mark.skill='燃烧';
            target._wulidebuff_ranshao_mark.firstChild.innerHTML='燃烧';
            target._wulidebuff_ranshao_mark.info.content=tishi;
        },target);                                           
    game.log('雷杀穿透护甲:',target,target.wulidebuff_ranshao,target._wulidebuff_ranshao_mark);
    },
                subSkill:{
                    jiansu:{
                        mod:{
                            globalTo:function(from,to,distance){return distance-to.hasMark('wulidebuff_jiansu');},
                        },
                        trigger:{
                            player:["phaseJieshuBegin","dying"],
                        },
                        name:"减速",
                        priority:3,
                        forced:true,
                        content:function(){//player.removeMark('wulidebuff_jiansu',player.countMark('wulidebuff_jiansu'));
        if(player.hasSkill('wulidebuff_jiansu')){ player.removeSkill('wulidebuff_jiansu');player.removeMark('wulidebuff_jiansu',player.countMark('wulidebuff_jiansu')); };
    },
                        intro:{
                            marktext:"减速",
                            content:function(player){
            return ('减少1点与其他角色的防御距离，令舰船更容易被对手集火，雷杀的效果，不叠加计算');
        },
                        },
                        sub:true,
                    },
                    jinshui:{
                        mod:{
                            maxHandcard:function(player,num){//手牌上限
        return num=num-1},
                        },
                        trigger:{
                            player:["phaseBegin","phaseJieshuBegin","dying"],
                        },
                        name:"进水",
                        priority:2,
                        forced:true,
                        content:function(){//player.removeMark('wulidebuff_jinshui',player.countMark('wulidebuff_jinshui')); 
        if(player.hasSkill('wulidebuff_jinshui')){ player.removeSkill('wulidebuff_jinshui');player.removeMark('wulidebuff_jinshui',player.countMark('wulidebuff_jinshui')); };
    },
                        intro:{
                            marktext:"进水",
                            content:function(player){
            return ('减少1点手牌上限，在出牌阶段会恢复，冰杀与袭击运输船的效果，不叠加计算也很可怕了');   
            },
                        },
                        sub:true,
                    },
                    ranshao:{
                        trigger:{
                            player:["phaseJieshuBegin","dying"],
                        },
                        name:"燃烧",
                        forced:true,
                        priority:1,
                        content:function(){//player.countMark('wulidebuff_ranshao'),唯一一个加伤的，还是给牌吧。player.removeMark('wulidebuff_ranshao',player.countMark('wulidebuff_ranshao')); player.identity=='nei'
                //+player.countMark('wulidebuff_ranshao')+'次，'+tishi
                   //var tishi='';if(player.countMark('wulidebuff_ranshao')>0&&player.hp<=2){ tishi+=('可能小命不保，求求队友给点力，发挥抽卡游戏的玄学力量。”')};if(player.countMark('wulidebuff_ranshao')>2&&player.hp<=2){tishi+=('“被集火了，希望队友能能继续扛起重任。')};if(player.identity=='nei'){tishi+=('为了自己的光辉岁月，我内奸一定能苟住，一定要苟住')};if(player.identity=='zhu'){tishi+=('我的生命在燃烧，')};if(player.identity=='zho'){tishi+=('同志，救我，我被火力压制了。')};if(player.identity=='fan'){tishi+=('就怕火攻一大片啊，我们的大好前程被火杀打到功亏一篑')};
        if(player.hasSkill('wulidebuff_ranshao')){if(event.triggername!='dying'){player.draw(1);player.damage(1,'fire');};player.removeSkill('wulidebuff_ranshao');player.removeMark('wulidebuff_ranshao',player.countMark('wulidebuff_ranshao'));  };  },
                        intro:{
                            marktext:"燃烧",
                            content:function(player){//+player.countMark('wulidebuff_ranshao')+'次，'+tishi
            var player=_status.event.player;var tishi='回合结束受到一点火焰伤害，摸一张牌，火杀带来的负面效果，本回合被攻击了'+player.countMark('wulidebuff_ranshao')+'次，';if(player.countMark('wulidebuff_ranshao')>0&&player.hp<=2){tishi+=('可能小命不保，求求队友给点力，发挥抽卡游戏的玄学力量。”')};if(player.countMark('wulidebuff_ranshao')>2&&player.hp<=2){tishi+=('“被集火了，希望队友能能继续扛起重任。')};if(player.identity=='nei'){tishi+=('为了自己的光辉岁月，我内奸一定能苟住，一定要苟住')};if(player.identity=='zhu'){tishi+=('我的生命在燃烧，')};if(player.identity=='zho'){tishi+=('同志，救我，我被火力压制了。')};if(player.identity=='fan'){tishi+=('就怕火攻一大片啊，我们的大好前程被火杀打到功亏一篑')};
            return tishi;  },
                        },
                        sub:true,
                        ai:{
                            effect:{
                                player:function(card,player){var a=game.countPlayer(function(current){ return current!=player&&(!get.attitude(player,current)<0&&(player.hasSkill=='zhongxunca'||player.hasSkill=='qingxun'));  });
 
                    if(card.name=='tengjia'){
                    var equip1=player.getEquip(1);if(a>0||player.hasSkill=='wulidebuff_ranshao'){return -10;};
                    if(a>0) return -1;}},
                            },
                        },
                    },
                },
            },
            junfu:{
                audio:"ext:舰R牌将:2",
                trigger:{
                    global:["phaseBegin","phaseJieshuBegin"],
                },
                direct:true,
                lastDo:true,
                frequent:true,
                preHidden:true,
                locked:false,
                filter:function(event,player,name){//输粮改((get.attitude(player,event.player)>0&&event.name=='phase')||(get.attitude(player,event.player)<=0&&event.name=='phaseJieshu')||event.player==player);
       //||event.player==player
        var a=((!player.getEnemies().contains(event.player)&&event.name=='phase')||(player.getEnemies().contains(event.player)&&event.name=='phaseJieshu'));
    return player.getExpansions('tunchu').length>0&&event.player.countCards('h')<8&&get.distance(player,event.player,'pure')<=1+player.countMark('jinengup')&&event.player.isAlive()&&a==true
    ;  },
                content:function(){//player:"phaseJieshuBegin",
        'step 0'
        var goon=(get.attitude(player,trigger.player)>0);game.log(trigger.name)
        player.chooseCardButton(get.prompt('junfu',trigger.player),player.getExpansions('tunchu')).set('ai',function(){
            if(_status.event.goon) return 1;
            return 1;
        }).set('goon',goon);
        'step 1'
        if(result.bool){
            player.logSkill('shuliang',trigger.player);
       //     player.loseToDiscardpile(result.links);trigger.player.draw(1)
            player.discoverCard(get.inpile('trick'));trigger.player.gain(result.links,player);}
    },
                ai:{
                    combo:"tunchu",
                },
                group:["junfu_choose","junfu_draw"],
                onremove:function(player,skill){
        var cards=player.getExpansions(skill);
        if(cards.length) player.loseToDiscardpile(cards);
    },
                intro:{
                    content:"expansion",
                    markcount:"expansion",
                },
                subSkill:{
                    choose:{
                        trigger:{
                            global:"phaseBegin",
                        },
                        forced:true,
                        popup:false,
                        firstDo:true,
                        filter:function(event,player){//输粮改
        return !player.getExpansions('tunchu').length;
    },
                        charlotte:true,
                        content:function(){
        'step 0'
     //   player.removeSkill('tunchu_choose');
        var nh=Math.min(player.countCards('h'),Math.ceil(player.getHandcardLimit()/2));
        if(nh){
            player.chooseCard('h',[1,nh],'将任意张手牌置于你的武将牌上').set('ai',function(card){
                var player=_status.event.player;
                var count=game.countPlayer(function(current){
                    return get.attitude(player,current)>0;//current.countCards('h')current.hp+1
                });
                if(ui.selected.cards.type=="equip") return -get.value(card);
                if(ui.selected.cards.length>=count) return -get.value(card);
                return 25-get.value(card);
                
            });
        }
        else{
            event.finish();
        }
        'step 1'
        if(result.bool){
            player.addToExpansion(result.cards,player,'giveAuto').gaintag.add('tunchu');
        }
    },
                        sub:true,
                    },
                    draw:{
                        trigger:{
                            player:"phaseDrawBegin2",
                        },
                        frequent:true,
                        priority:2,
                        preHidden:true,
                        locked:false,
                        filter:function(event,player){//"粮油运输","屯粮油","仓储","qingnang"
    return true;
    },
                        content:function(){
        trigger.num-=2;
},
                        sub:true,
                    },
                },
            },
            quzhudd:{
                mod:{
                    globalFrom:function(from,to,distance)  { return distance-(to.hasSkill('qianting'));},
                },
                group:[],
                ai:{
                    expose:0,
                    threaten:4.8,
                    order:5,
                    result:{
                        player:1,
                    },
                },
                intro:{
                    content:function(){
            return get.translation(skill);
        },
                },
            },
            daoqu:{
                mod:{
                    selectTarget:function(card,player,range){///是卡片作用时可选的目标数量，输出range给牌的发起事件阶段用。
            if(range[1]==-1) return;
            if(card.name=='sha') range[1]+=player.countMark('jinengup');},
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            huibi:{
                inherit:"bagua_skill",
                audio:"bagua_skill",
                firstDo:true,
                content:function(){//已经有一个给牌技能了
        "step 0"
        event.cards=[];
        player.judge('huibi',function(card){return (get.name(card)=='tao'||get.name(card)=='shan'||get.suit(card)=='diamond')?1.6:-0.5}).judge2=function(result){
          return result.bool;
        };
        "step 1"
        if(result.judge>0){
            trigger.untrigger();player.removeMark('huibi',player.countMark('huibi'));
            trigger.set('responded',true);
            trigger.result={bool:true,card:{name:'shan'}}
        };if(result.judge<=0){event.cards.push(result.card);if(Math.max(player.getHandcardLimit(),3)>=player.countCards('h')){player.gain(event.cards);
  //var next=player.chooseToDiscard(get.prompt('回避弃牌事件'),1,'手牌数超过上限，请弃置一张手牌',true);
    //    next.ai=function(card){
              //  return 30-get.useful(card);}
            
              };
   //if(player.hasSkill('quzhudd')){if(!player.countMark('huibi')){player.addMark('huibi');event.goto(0);}else {player.removeMark('huibi',player.countMark('huibi'));};};
        };
    
    },
                equipSkill:true,
                trigger:{
                    player:["chooseToRespondBegin","chooseToUseBegin"],
                },
                filter:function(event,player){
        if(event.responded) return false;
        if(event.huibi) return false;
        if(!event.filterCard||!event.filterCard({name:'shan'},player,event)) return false;
        if(event.name=='chooseToRespond'&&!lib.filter.cardRespondable({name:'shan'},player,event)) return false;
      if(player.hasSkillTag('unequip2')) return false;
        var evt=event.getParent();
        if(evt.player&&evt.player.hasSkillTag('unequip',false,{
            name:evt.card?evt.card.name:null,
            target:player,
            card:evt.card
        })) return false;
        return true;
    },
                check:function(event,player){
        if(event&&(event.ai||event.ai1)){
            var ai=event.ai||event.ai1;
            var tmp=_status.event;
            _status.event=event;
            var result=ai({name:'shan'},_status.event.player,event);
            _status.event=tmp;
            return result>0;
        }
        return true;
    },
                ai:{
                    respondShan:true,
                    effect:{
                        target:function(card,player,target,effect){
                if(target.hasSkillTag('unequip2')) return;
                if(player.hasSkillTag('unequip',false,{
                    name:card?card.name:null,
                    target:target,
                    card:card
                })||player.hasSkillTag('unequip_ai',false,{
                    name:card?card.name:null,
                    target:target,
                    card:card
                })) return;
                if(get.tag(card,'respondShan')) return 0.5;
            },
                    },
                },
                intro:{
                    content:function(){
            return get.translation(huibi+'_info');
        },
                },
            },
            "hanbing_gai":{
                inherit:"hanbing_skill",
                trigger:{
                    source:"damageBegin2",
                },
                equipSkill:false,
                ruleSkill:true,
                firstDo:true,
                filter:function(event,player){//||player.hasSkill('hanbing_gai')
        return (event.nature=='thunder')&&event.notLink()&&event.player.getCards('he').length>0;
    },
                audio:"ext:舰R牌将:true",
                check:function(event,player){
var target=event.player;
var eff=get.damageEffect(target,player,player,event.nature);
if(get.attitude(player,target)>0){
if(eff>=0) return false;
return true;
}
if(eff<=0) return true;
if(target.hp>=2&&target.countCards('he')>=2&&player.hasSkill('yunqingleng')&&player.getHistory('useCard',function(evt){
return evt.card.name=='jiu'
}).length<=0) return true;
if(target.hp==1) return false;
if(player.getHistory('useCard',function(evt){
return evt.card.name=='jiu'
}).length>=1) return false;
if(event.num>1||player.hasSkill('tianxianjiu')||
player.hasSkill('luoyi2')||player.hasSkill('reluoyi2')) return false;
if(target.countCards('he')<2) return false;
var num=0;
var cards=target.getCards('he');
for(var i=0;i<cards.length;i++){
if(get.value(cards[i])>=6) num++;
}
if(num>=3&&player.getHistory('useCard',function(evt){
return evt.card.name=='jiu'
}).length<=0) return true;
if(num>=2&&target.hasSkillTag("maixie")&&player.getHistory('useCard',function(evt){
return evt.card.name=='jiu'
}).length<=0) return true;
if(num>=2&&player.hasSkill('yunqingleng')&&player.getHistory('useCard',function(evt){
return evt.card.name=='jiu'
}).length<=0) return true;
return false;
},
                logTarget:"player",
                content:function(){
"step 0"
event.num1=trigger.num*2;game.log(trigger.num,event.num1)
trigger.cancel();
"step 1"
if(trigger.player.countDiscardableCards(player,'he')){
player.line(trigger.player);
player.discardPlayerCard('he',trigger.player,true);player.addMark('hanbing_gai');
}else {var a=Math.floor((event.num1-player.countMark('hanbing_gai'))/2);game.log(event.num1,Math.floor((event.num1-player.countMark('hanbing_gai'))/2));
 player.removeMark('hanbing_gai',player.countMark('hanbing_gai'));trigger.player.damage(a);event.finish;};
"step 2"
if(player.countMark('hanbing_gai')<event.num1&&player.countMark('hanbing_gai')){event.goto(1)}else {
 player.removeMark('hanbing_gai',player.countMark('hanbing_gai'));};
},
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
            qianghuazhuang:{
                mod:{
                    attackFrom:function(from,to,distance){
  var a=0;if(from.countMark('wuqiup')){var a=a+from.countMark('wuqiup')};return distance=(distance-a)},
                    attackTo:function(from,to,distance){
  var a=0;if(to.countMark('jidongup')){var a=a+to.countMark('jidongup')};return distance=(distance+a)},
                    cardUsable:function( card,player,num){
  var a=0;if(card.name=='sha') return num=num+=(player.countMark('useshaup'))},
                    maxHandcard:function(player,num){
  var a=0;if(player.countMark('shoupaiup')){var a=a+player.countMark('shoupaiup')};  return num=(num+a);},
                },
                direct:true,
                mark:true,
                init:function(player){//初始化数组，也可以运行事件再加if后面的内容
    if(!player.storage.qianghuazhuang) player.storage.qianghuazhuang=[0,0,0,0,0,0,0,0,0];},
                getInfo:function(player){//让其他技能可以更简单的获取该技能的数组。
    if(!player.storage.qianghuazhuang) player.storage.qianghuazhuang=[0,0,0,0,0,0,0,0,0];
    return player.storage.qianghuazhuang;},
                intro:{
                    marktext:"装备",
                    content:function(storage,player){//只有content与mark可以function吧，内容，介绍的文字与内容。
 var info=lib.skill.qianghuazhuang.getInfo(player);
  return '<div class="text center"><span class=greentext>用一摸一:'+info[0]+'<br>技能耗牌：'+info[1]+'</span><br><span class=firetext>武器距离：'+info[2]+'<br>攻击次数:'+info[3]+'</span><br><span class=thundertext>机动：'+info[4]+'<br>手牌上限:'+info[5]+'</span><br><span class=yellowtext>辅助技能：'+info[6]+'<br>Exp:'+info[7]+'</span></div>'
     ;     },
                },
                enable:"phaseUse",
                usable:2,
                filter:function(event,player){//if (player.countCards('he',{type:'equip'})>0){if((a+b+c+d)>(4+k*4))return false} return player.countCards('he',{type:'equip'})>0||player.countMark('Expup')>0;type:"equip",
       var a=player.countMark('mopaiup'),b=player.countMark('jinengup'), c=player.countMark('wuqiup') , d=player.countMark('useshaup'),e=player.countMark('jidongup'),  f=player.countMark('shoupaiup'), g=player.countMark('songpaiup') , h=player.countMark('Expup'),k=player.countMark('jianzaochuan')+1,lv=0;if(k<3){lv=k*6};if(k>=3){lv=k+10};
       if(player.countCards('he')>0){if((a+b+c+d+e+f+g)>=(lv))return false}; return player.countCards('he')>0||player.countMark('Expup')>0;
     //比较保守的设计，便于设计与更改。
    ;},
                filterCard:{
                },
                position:"he",
                selectCard:[0,3],
                prompt:"你可以消耗经验，或弃置一至三张牌，选择一个永久效果升级。<br>（如摸牌、攻击距离、手牌上限等）每回合限两次,最多四次，强化上限为你发动建造的尝试，摸牌最高强化至5级，其他为2级。",
                check:function(card){//ui，参考仁德，ai执行判断，卡牌价值大于1就执行（只管卡片）当然，能把玩家设置进来就可以if玩家没桃 return-1。
        var player=_status.event.player;
        if(ui.selected.cards.length&&ui.selected.cards[0].name=='zhuge') return 0;
        if(ui.selected.cards.length>=Math.max(1,player.countCards('h')/3)) return 0;
        if(game.phaseNumber<2)return 11-get.value(card);
        return 5-get.value(card);
    },
                content:function(){//choiceList.unshift
         'step 0'
 var a=player.countMark('mopaiup'),b=player.countMark('jinengup'), c=player.countMark('wuqiup') , d=player.countMark('useshaup'),e=player.countMark('jidongup'),  f=player.countMark('shoupaiup'), g=player.countMark('songpaiup') , h=player.countMark('Expup'),k=player.countMark('jianzaochuan')+1;
 player.storage.qianghuazhuang=[a,b,c,d,e,f,g,h,k];game.log('已强化:',a+b+c+d);event.cadechangdu=event.cards.length;
   event.choiceList=[ ]; event.list=[ ]; event.cao=cards ;//player.getEquip(1)，定义空数组，push填充它，事件变量可以自定义名字，什么都可以存。
        var info=lib.skill.qianghuazhuang.getInfo(player);
        if(info[0]<k&&info[0]<5){event.list.push('mopaiup');
   event.choiceList.push('+'+a+'→'+(a+1)+'摸牌标记上限，<br>防守反击必备。');};
        if(info[1]<k&&info[1]<2){event.list.push('jinengup');
   event.choiceList.push('+'+(b)+'→'+(b+1)+'技能的作用，降低重巡、战列使用必中攻击时所需的手牌数;<br>增加导驱用杀时可选的目标数、潜艇用普通(非延时)锦囊牌时可选的目标数;轻巡能令更远距离的友军增加摸牌阶段摸牌数、军辅能于更远距离给其他角色递牌。');};
        if(info[2]<k&&info[2]<2){event.list.push('wuqiup');
   event.choiceList.push('+'+c+'→'+(c+1)+'武器攻击距离，<br>不如古锭刀和减一马');};//若此值：你强化的比目标多时，+1含锦囊牌防御距离。
        if(info[3]<k&&info[3]<2){event.list.push('useshaup');
    event.choiceList.push('+'+d+'→'+(d+1)+'出杀次数，<br>不再依赖连弩，但有连弩更好。');};
        if(info[4]<k&&info[4]<2){event.list.push('jidongup');
   event.choiceList.push('+'+e+'→'+(e+1)+'武器防御距离<br>不如加1马，但仍能让对手的烦恼。');};
        if(info[5]<k&&info[5]<2){event.list.push('shoupaiup');
   event.choiceList.push('+'+f+'→'+(f+1)+'手牌上限，能于更远距离给其他角色递牌给杀，<br>一般是用来降低摸牌门槛。');};
  //      if(info[6]<k&&info[6]<2){event.list.push('songpaiup');
 //  event.choiceList.push('+'+g+'→'+(g+1)+'给牌次数，<br>提升“先进雷达”技能的送牌范围。');};
      if(info[7]<k&&info[7]<2){event.list.push('Expup');
   event.choiceList.push('+'+h+'→'+(h+1)+'经验，将没有机会用来强化的卡牌转为经验，供下次升级<br>'+(h+1)+'建造次数');};
        event.first=true;    //存了6个变量，可以导出为button，与textbutton样式，看需求
        var next=player.chooseButton([
            '请令其中一项+1；可以取消，取消后会返还卡牌；升级后，多的卡牌会转化为经验，供下次升级使用。',
            [event.choiceList,'textbutton'],
        ]);
        next.set('selectButton',[1,event.cadechangdu+player.countMark('Expup')]);//可以选择多个按钮，可计算可加变量。
        next.set('prompt',get.prompt('qianghuazhuang'),'令其中一项+1,好吧不显示info');
        next.set('ai',function(button){var haode=[event.choiceList[0],event.choiceList[3]];//其实一个例子就行，不如直接if(){return 2;};
            switch(ui.selected.buttons.length){
                case 0:
                    if(haode.contains(button.link)) return 2;
                    
                    return Math.random();
                case 1:
                    
                    if(haode.contains(button.link)) return 2;
                    return Math.random();
                case 2:
                    if(haode.contains(button.link)) return 2;
                  return Math.random();
                default: return 0;
            }
        });
 
            'step 1'
            game.log(result.links,result.bool)//只能返还这两个，所以更适合技能，更需要循环的方式进行计算。
     if(!result.bool){;player.gain(event.cao,player);event.finish;};//返还牌再计算
     if(result.bool){  player.addMark('Expup',event.cadechangdu);2//先给经验再计算
        for(var i=0;i<event.choiceList.length;i+=(1)){if( result.links.contains(event.choiceList[i])){  player.addMark(event.list[i],1);player.removeMark('Expup',1);game.log('数组自动识别、升级:',event.list[i],'编号',i,'，总编号',result.links.length-1,'，经验-1');}}};
    //    if(event.choiceList.length<event.cao){player.addMark('Expup',1);};从0开始，当介绍数组有内容==选项数组的内容（第i个），就加的简称数组第i个(内容)标签。并写上调试内容。记录查看效果。
            'step 2'
  var a=player.countMark('mopaiup'),b=player.countMark('jinengup'), c=player.countMark('wuqiup') , d=player.countMark('useshaup'),e=player.countMark('jidongup'),  f=player.countMark('shoupaiup'), g=player.countMark('songpaiup') , h=player.countMark('Expup'),k=player.countMark('jianzaochuan')+1;game.log('结束',a,b,c,d,e,f,g,h,k);
 player.storage.qianghuazhuang=[a,b,c,d,e,f,g,h];

    
    
    
    
    },
                ai:{
                    order:function(player){var player=_status.event.player;if(player.countMark('jianzaochuan')<3){return 9};return 1},
                    threaten:0,
                    result:{
                        player:function(player){var player=_status.event.player;
                var num=player.countCards('e')+player.countCards('h',{name:'shan'})-2;
            return num;},
                    },
                },
            },
            huokongld:{
                equipSkill:true,
                trigger:{
                    player:["shaMiss","eventNeutralized"],
                },
                direct:true,
                audio:"ext:舰R牌将:true",
                filter:function(event,player){
        if(event.type!='card'||event.card.name!='sha') return false;
        return player.countCards('he',function(card){
            return card!=player.getEquip('guanshi');
        })>=Math.max(0,2-player.countMark('jinengup'))&&event.target.isAlive();
    },
                content:function(){
        "step 0"
        if(player.countMark('jinengup')<2){
        var next=player.chooseToDiscard(get.prompt2('huokongld'),Math.max(0,2-player.countMark('jinengup')),'he',function(card){
            return _status.event.player.getEquip('guanshi')!=card;
        });
        next.logSkill='guanshi_skill';
        next.set('ai',function(card){
            var evt=_status.event.getTrigger();
            if(get.attitude(evt.player,evt.target)<0){
                if(evt.baseDamage+evt.extraDamage>=Math.min(2,evt.target.hp)){
                    return 8-get.value(card)
                }
                return 5-get.value(card)
            }
            return -1;
        });}else player.chooseControl('<span class=yellowtext>强制命中'+'</span>','cancel2').set('prompt',get.prompt('huokongld')).set('prompt2','令攻击命中对手').set('ai',function(card){
            var evt=_status.event.getTrigger();
            if(get.attitude(evt.player,evt.target)<0){
                if(evt.baseDamage+evt.extraDamage>=Math.min(2,evt.target.hp)){
                    return 1.1
                }
                return 1
            }
            return -1;
        });
        "step 1"
        if(result.bool||result.index==0){
            if(event.triggername=='shaMiss'){
                trigger.untrigger();
                trigger.trigger('shaHit');
                trigger._result.bool=false;
                trigger._result.result=null;
            }
            else{
                trigger.unneutralize();
            }
        }
    },
                ai:{
                    "directHit_ai":true,
                    skillTagFilter:function(player,tag,arg){
            if(player._guanshi_temp) return;
            player._guanshi_temp=true;
            var bool=(get.attitude(player,arg.target)<0&&arg.card.name=='sha'&&player.countCards('he',function(card){
                return card!=player.getEquip('guanshi')&&card!=arg.card&&(!arg.card.cards||!arg.card.cards.contains(card))&&get.value(card)<5;
            })>1);
            delete player._guanshi_temp;
            return bool;
        },
                },
            },
            "测试":{
                audio:"dili",
                trigger:{
                    player:"logSkill",
                },
                forced:true,
                juexingji:true,
                skillAnimation:true,
                animationColor:"wood",
                filter:function(event,player){
        if(event.skill!='junkyuheng') return false;
        var skills=player.getSkills(null,false,false).filter(function(i){
            var info=get.info(i);
            return info&&!info.charlotte;
        });
        return skills.length>player.maxHp;
    },
                content:function(){
        'step 0'
        player.awakenSkill('junkdili');
        player.loseMaxHp();
        'step 1'
        var skills=player.getSkills(null,false,false).filter(function(i){
            if(i=='junkdili') return false;
            var info=get.info(i);
            return info&&!info.charlotte;
        });
        var list=[];
        for(var skill of skills){
            list.push([
                skill,
                '<div class="popup text" style="width:calc(100% - 10px);display:inline-block"><div class="skill">【'+get.translation(skill)+'】</div><div>'+lib.translate[skill+'_info']+'</div></div>',
            ])
        }
        var next=player.chooseButton([
            '请选择失去任意个技能',
            [list,'textbutton'],
        ]);
        next.set('forced',true);
        next.set('selectButton',[1,skills.length]);
        next.set('ai',function(button){
            var skill=button.link,skills=_status.event.skills.slice(0);
            skills.removeArray(['xinanguo','lanjiang','rezhiheng','junkyuheng']);
            switch(ui.selected.buttons.length){
                case 0:
                    if(skills.contains(skill)) return 2;
                    if(skill=='junkyuheng') return 1;
                    return Math.random();
                case 1:
                    if(skills.length<2) return 0;
                    if(skills.contains(skill)) return 2;
                    if(skill=='junkyuheng') return 1;
                    return 0
                case 2:
                    if(skills.contains(skill)) return 2;
                    if(skill=='junkyuheng') return 1;
                    return 0;
                default: return 0;
            }
        });
        next.set('skills',skills)
        'step 2'
        if(result.bool){
            var skills=result.links;
            game.log(player,'失去了以下技能：','#g'+get.translation(skills));
            player.removeSkill(skills.slice(0));
        }
        var list=lib.skill.junkdili.derivation;
        for(var i=0;i<Math.min(skills.length,list.length);i++){
            player.addSkillLog(list[i]);
        }
    },
                derivation:["junkshengzhi","junkquandao","junkchigang"],
            },
            ce:{
                enable:"phaseUse",
                usable:1,
                position:"he",
                filterCard:true,
                selectCard:function(){
        var player=_status.event.player;
        return player.getDamagedHp();
    },
                filterTarget:function(card,player,target){
        return target.hp<target.maxHp;
    },
                filter:function(event,player){
        return player.hp<player.maxHp;
    },
                selectTarget:function(){
        return [1,ui.selected.cards.length];
    },
                complexSelect:true,
                check:function(card){
        if(get.color(card)=='black') return -1;
        return 9-get.value(card);
    },
            },
            fangkoganning:{
                audio:"ext:舰R牌将:1",
                audioname:["yixian","sunce","re_sunben","re_sunce","ol_sunjian"],
                unique:true,
                nodelay:true,
                trigger:{
                    global:"useCardToPlayered",
                },
                filter:function(event,player){
        if(event.getParent().triggeredTargets3.length>1) return false;
        if(get.type(event.card)!='trick') return false;
        if(get.info(event.card).multitarget) return false;
        if(event.targets.length<2&&!get.attitude(player,event.target)>=0) return false;
    //    if(player.storage.fangkoganning) return false;
        return true;
    },
                direct:true,
                content:function(){//limited:true,
    "step 0"
    player.update();//game.log(trigger.targets);
    var discard=player.countCards('he');
    var next=player.chooseToDiscard(get.prompt('防空弃牌事件'),[1,Math.min(trigger.targets.length,Math.floor(player.countCards('he')))],'弃置两倍的手牌并让锦囊牌对目标角色无效');
    next.setHiddenSkill('fangkoganning');//还要隐藏还行skillAnimation:true,    animationColor:"wood",
    next.ai=function(card){
        if(discard){
            return 8-get.useful(card);
        }
        else{
            return -1;
        }
 } ; 
    "step 1"
    if(result.bool){
        player.chooseTarget(get.prompt('防空保护对象'),('X为选择的角色数，当一名角色使用的锦囊牌指定了至少两名角色为目标时，你可以消耗X的手牌，令此牌对X名角色无效。'),result.cards.length
       ,function(card,player,target){
       return _status.event.targets.contains(target)&&!target.hasSkill('fangkoganning_aibiexuan');
    }).set('ai',function(target){
   var trigger=_status.event.getTrigger();
   //if(game.phaseNumber>game.players.length&&trigger.targets.length>=game.players.length-1&&!trigger.excluded.contains(target))  {
    return -get.effect(target,trigger.card,trigger.player,_status.event.player);
   // }
        return -1;
    }).set('target',trigger.target);
          };
    "step 2"
    if(result.bool){//trigger.getParent()找上个事件（万箭齐发）//     getStat是操作次数的，skillCount是获取次数的，相当于一个get一个set，prompt里面应该是不能去set
      //  出现觉醒标识的player.awakenSkill('防空');与拖时间播录音的game.delay();以及真正完成觉醒技只能用一次的player.storage.fenwei=true;
        
       // player.storage.fangkoganning=true;
        game.delay();event.target=result.targets//event的赋值不需要var 可以一直使用的事件结束
        trigger.getParent().excluded.addArray(event.target);player.logSkill('fangkoganning',event.target);
        event.finish;
    }
    
    },
                subSkill:{
                    aibiexuan:{
                        trigger:{
                            player:"useCardEnd",
                        },
                        forced:true,
                        content:function(){game.log('保护结束')
                player.removeSkill('fangkoganning_aibiexuan');
            },
                        sub:true,
                    },
                },
            },
            "ganglie_gai":{
                audio:"ext:舰R牌将:2",
                trigger:{
                    player:"damageEnd",
                },
                filter:function(event,player){
        return (event.source!=undefined&&event.source!=player&&event.player.hp<=event.player.maxHp/2);
    },
                check:function(event,player){
        return (get.attitude(player,event.source)<=0);
    },
                logTarget:"source",
                content:function(){  "step 0"//if(player.countCards('h')>=3) event.tishi+=('');
        event.num=trigger.num;if(trigger.hujia){event.num=1};event.tishi='你可以弃置x张牌并进行判定。<br>若结果不为红桃，则伤害来源顺序选择执行一项：1.弃置x+1张手牌，2.选择交给你一张牌;3.都未执行，则其失去一点体力(无视护甲)。<br>若你先弃置了两张牌，则判定失败时可以获得目标的一张牌;目标来到选择2面前前，会额外失去一张牌。';var shili=trigger.source.countCards('he')/player.countCards('he');
   if(player.countCards('h')>=3){event.tishi+=('<br>');if(shili>=1.5) {event.tishi+=('对手处于优势，希望此技能 能成功减弱对手的攻势吧')};if(shili<1.5&&shili>=1.2){ event.tishi+=('对手处于优势，尝试获取廉价的收益吧')};if(shili<1.2&&shili>=0.8){ event.tishi+=('即将打破的僵持状况，稳住心态')};if(shili<0.8){ event.tishi+=('稳妥起见，多弃置一张也无妨，有一个弱化的顺手牵羊作为保底嘛')};};
                   "step 1"
      if(trigger.source.isAlive()){  player.chooseToDiscard([0,2]).set('prompt2',event.tishi).set('ai',function(card){
          　if(ui.selected.cards.length) return -1;
            if(card.name=='tao') return -10;
            if(card.name=='jiu'&&_status.event.player.hp==1) return -10;
            return get.unuseful(card)+2.5*(5-get.owner(card).hp);
        });};
        "step 2"//game.log(result.cards);  
   //   if(result.bool){
          event.num-=(1);if(result.bool){event.qipai=result.cards.length;}else event.qipai=0;
        player.judge(function(card){
            if(get.suit(card)=='heart') return -2;
            return 2;
        }).judge2=function(result){
            return result.bool;
        };//}else event.finish();
        "step 3"
        if(result.judge<2){
            event.finish();if(event.qipai>1){player.gainPlayerCard(true,trigger.source,'he');};
        }else {event.tishi='作为伤害来源，顺序执行：<br>1.弃置x+1张手牌，2.选择交给'+get.translation(player)+'一张手牌;3.前两项都不执行，则你失去一点体力(无视护甲)。<br>';if(event.qipai>1){ event.tishi+=('对手先弃置了两张牌，其判定失败时，可以获得你的一张牌；你进行选择2前，会额外失去一张牌。')};
        trigger.source.chooseToDiscard(1+event.qipai).set('prompt2',event.tishi).set('ai',function(card){
            if(card.name=='tao') return -10;
            if(card.name=='jiu'&&_status.event.player.hp==1) return -10;
            return get.unuseful(card)+2.5*(5-get.owner(card).hp);
        });};
        "step 4"
        if(result.bool==false){event.tishi='作为伤害来源：2.选择交给'+get.translation(player)+'一张手牌;<br>3.不执行，则自己失去一点体力(无视护甲)。<br>';if(event.qipai>1){event.tishi+=('对手先弃置了两张牌，你进行选择2前，若手牌大于1，会额外失去一张牌。<br>');if(trigger.source.countCards('h')>=2){trigger.source.discard(trigger.source.getCards('h').randomGet());};};
       if(trigger.source.countCards('h',{name:'tao'})>=0) {event.tishi+=('有桃，不怕扣血；')};if(trigger.source.countCards('h',{name:'jiu'})>=0) {event.tishi+=('有酒,没血不慌；')};if(trigger.source.countCards('h',{name:'shandian'})+trigger.source.countCards('h',{name:'taoyuan'})>=0) {event.tishi+=('有些稀有卡牌能变废为宝，转给对手')};
        if(!trigger.source.countCards('h')) event._result={bool:false};
        else trigger.source.chooseCard('h').set('prompt2',event.tishi).set('ai',function(card){
            if(get.attitude(_status.event.player,_status.event.getParent().player)>0){
           //     if(card.name=='tao') return 10;
            //    if(card.name=='jiu'&&_status.event.player.hp!=1) return 10;
                if(get.suit(card)!='heart') return 13-get.value(card);
                return 11-get.value(card);
            }
            else{
                if(card.name=='tao') return -10;
            if(card.name=='jiu'&&_status.event.player.hp==1) return -10;
            return get.unuseful(card)+2.5*(5-get.owner(card).hp);
            }
        });};
        'step 5'
        if(result.bool){
            var card=result.cards[0];
            
            trigger.source.give(card,player);
        }
        else{
            trigger.source.loseHp();};
        if(event.num>0){event.goto(1)};
    },
                ai:{
                    "maixie_defend":true,
                    effect:{
                        target:function(card,player,target){
                if(player.hasSkillTag('jueqing',false,target)) return [1,-1];
                return 0.8;
                // if(get.tag(card,'damage')&&get.damageEffect(target,player,player)>0) return [1,0,0,-1.5];
            },
                    },
                },
                intro:{
                    content:function(){
            return get.translation(skill+'_info');
        },
                },
            },
        },
        translate:{
            tiaozhanzhuanbei:"手枪",
            "tiaozhanzhuanbei_info":"挑战锁定技，游戏开始时，你将一张【幸运】【炮火准备】和一张【望远镜】置入你的装备区。你装备区内的武器牌和宝物牌不能被其他角色弃置。",
            danzong:"增强杀",
            "danzong_info":"每回合限两次，使用杀时：<br>没如下舰种时：切为高爆弹，令非属性杀获得火属性,点燃目标。<br>潜艇、驱逐：发射鱼(雷)，令非属性杀获得雷属性的效果，目标有失血防守技能或者护甲时会流失体力<br>战列、航母：使用穿甲弹,令非属性杀获得雷属性与改进型冰杀的效果。<br>效果持续到伤害结算完成时",
            huihejieshu:"回合开始",
            "huihejieshu_info":"移除所有进水、减速、燃烧、摸牌标记，若你没有闪，你可以摸一张牌，轻巡触发此技能时可以多摸一张",
            qianghuachuan:"强化舰船",
            "qianghuachuan_info":"每回合限两次，你可以弃置一张装备牌,强化舰船的攻击距离、攻击次数、响应摸牌和防御距离四个属性，最多升级三次。(用装备换长久利益，可以通过改造增加1点血量上限与2次强化上限哦,取消返还装备)<span class=thundertext>0</span>，<span class=firetext>0</span>，<span class=greentext>0</span>，<span class=yellowtext>0</span>",
            jianzaochuan:"建造",
            "jianzaochuan_info":"当此角色强化了一次以后,或处于濒死状态时，你可弃三张同花色的牌，回复一点体力,受伤时额外回复一点体力，没进入濒死会提升一点体力上限,重复改造只会回一点体力。",
            "paohuozb_skill":"炮火准备1",
            "paohuozb_skill_info":"e",
            fupaozu:"副炮",
            "fupaozu_info":"每回合限一次，在没有杀或者不能出杀时，可弃置最多五张同花牌，耗n-2滴血，n为弃牌数,对你选择的目标视为出n-1个杀(第一个选择只是优化ai表现用的)，<br>弃置达到（4，5）时使用的杀拥有属性杀，极限4发,技能结束后会获得奇袭技能",
            zhuangjiafh:"装甲防护",
            "zhuangjiafh_info":"受伤时,若护甲值没有变化，则你可以在受伤前或受伤后，弃置一张红色手牌，获得1点护甲。<br>若已经没有满足条件的手牌可以弃置，会直接加1点护甲。<br>拥有此技能，则ai不会用护盾防御雷伤，还能精确到伤害开始前、结束时。",
            hangmucv:"航母",
            "hangmucv_info":"受伤时手牌上限+1，出杀次数+1。血量一般的舰船，能在每一轮开始时攻击三次，在优秀的队友帮助下避开抽卡高峰期发挥火力,但过牌少，没有强制命中，对阵多个轻型单位时很弱。死而复生后获得界连营。",
            yuanhang:"远航",
            "yuanhang_info":"最后的幸运：<br>当失去手牌后，若手牌数下降至手牌上限/2+1，且你有摸牌标记时，你摸1张牌，然后失去1个摸牌标记，其他人回合开始时回复一个标记，直至标记上限x+1个，自己回合则回满标记。可在强化中提升X值。<br>进入濒死时，你摸一张牌并获得一些技能，体力上限大于二时需减少一点体力上限，补偿一张牌；死亡后，令一名角色摸三张牌。<br>主公技，开局获得一点护盾，失去一点体力，发现一张基本牌。",
            qianting:"潜艇",
            "qianting_info":"手牌上限+3，受伤时出杀次数+1，攻击距离不变，锦囊距离+1,锦囊牌多指定x个目标数（x技能强化的次数）。可以拿对手牌，给队友牌。手短没防具，还得依赖火攻输出，非常容易去世。改造后增加锦囊牌伤害1点，濒死复生后获得截粮减少对手过牌量，复活后选择一项获得：八阵、看破和火攻。",
            zhanliebb:"战列",
            "zhanliebb_info":"受伤时手牌上限+1，出杀次数+1。受伤后可用黑色牌得护甲，回血也加护甲，可以弃置n张红色手牌额外出杀，但减速后会被对手集火，需要队友给牌给桃，濒死复生后获得刚烈以减轻承伤压力。",
            qingxuncl:"轻巡",
            "qingxuncl_info":"手牌上限+2，受伤时出杀次数+1。摸牌阶段时，摸牌数-2并发现一张基本牌。利用手牌能力优秀的辅助舰船，有八卦省牌，青囊回血，奋威防御多目标锦囊牌，为队友保驾护航。比较依赖燃烧伤害。濒死复生后，增加丈八蛇矛技能，进一步提高手牌利用率。",
            zhongxunca:"重巡",
            "zhongxunca_info":"受伤时手牌上限+1，出杀次数+1。可用黑色牌得护甲，让杀点燃对手，持续消耗对手的血量。可以弃置n张红色手牌杀指定目标n-1次，但怕被减速导致的集火暴打。濒死复生后获得刚烈以减轻承伤压力，以及仁德回血。",
            misscoversha:"回出杀数",
            "misscoversha_info":"杀被回避会回复当回合出杀次数",
            roundonefire:"先制攻击",
            "roundonefire_info":"一轮游戏开始时选择发动：航母可以弃置两张手牌，视为对非友方角色使用万箭齐发。潜艇可以弃置一张牌，对一个目标使用一张雷杀。没有手牌会结束此技能。能加快战局推进的技能。",
            xianjinld:"先进雷达",
            "xianjinld_info":"增益，所有队友：武器攻击距离+1，实际距离此角色为1的队友：摸牌阶段多摸一张牌；自己摸牌阶段少抽一张牌，并发现一张基本牌。",
            "rendeonly2":"仁德界改",
            "rendeonly2_info":"给实际距离为1的队友最多两张牌，一回合限2次，给出第二张牌时，你视为使用一张基本牌。",
            diewulimitai:"递杀蝶舞",
            "diewulimitai_info":"给实际距离为1的队友递一张杀或装备牌，一回合限2次。",
            foundtrick:"摸锦囊",
            "foundtrick_info":"锦囊牌伤害加1（如果已经改造完成）。<br>出牌阶段开始时，你发现一张锦囊牌，然后弃置一张牌。",
            kanpolimitai:"制空权",
            "kanpolimitai_info":"看破弱化版，将一张黑色手牌当无懈可击使用，每回合限一次。",
            fangkoganning:"防空",
            "fangkoganning_info":"X为选择的角色数，当一名角色使用的锦囊牌指定了至少两名角色为目标时，<br>你可以出一张杀先发制人，或者消耗X的手牌，令此牌对X名角色无效。<br>(由于机制问题，主动技能完整的转为被动技能比较麻烦))",
            kaifa:"开发装备",
            "kaifa_info":"出牌阶段，你可以展示一张未强化过的【诸葛连弩】或标准包/军争包/SP包中的防具牌，然后对其进行强化。当你处于濒死状态时，你可以重铸一张防具牌，然后将体力回复至1点。",
            huijiahuihe:"额外回合",
            "huijiahuihe_info":"祭祀：有护盾就能进行额外回合；发动后重置回合限制技能；额外回合的摸牌数等于护甲数。",
            touxichuan:"袭击",
            "touxichuan_info":"每回合限两次，弃置自己一张手牌，弃置对手的一张牌，并为对手施加进水debuff。",
            wulidebuff:"雷火永续",
            "wulidebuff_info":"火杀：令目标回合结束受到一点火焰伤害，摸一张牌，重巡火杀打改造驱逐加1伤。</br>冰杀：护甲加1伤；减少对手1点防御距离，方便队友集火对手；战列冰杀打改造重巡加1伤害。</br>雷杀：自动判断是否流失对手体力；减少对手1点手牌上限；潜艇、驱逐雷杀改造战列、航母时加1伤害。",
            junfu:"军辅船",
            "junfu_info":"摸牌阶段摸牌数-2，手牌上限+3，受伤时出杀+1。可以给其他人送牌，濒死给青囊技能<br>其他人回合开始时,你可以把不大于手牌上限一半的手牌存于武将牌上。实际距离为1+x的队友回合开始时，或对手回合结束时可以把一张牌交给ta，令你发现一张锦囊牌，让目标获得此牌。<br>(群伤卡牌的提供者)(存手牌数的一半好点，目标手牌数<8才能触发技能)。",
            quzhudd:"驱逐舰",
            "quzhudd_info":"手牌上限+2，受伤时出杀+1。可以给其他人送牌。闪避拉满，给队友牌狠，自己单干也狠，适合与驱逐队友配合，创造秒杀对面的时机。濒死但被救活后，能把对手的杀从队友传给自己。",
            daoqu:"导驱",
            "daoqu_info":"手牌上限+2，受伤时出杀+1。开局发现一张装备牌。使用杀时多指定x名敌人。(x为技能消化的强化数))",
            huibi:"回避(八卦)",
            "huibi_info":"可以进行一次判定，为桃、闪、方块，则视为打出闪。<br>若判定未生效,且手牌数在手牌上限以下，你会获得判定牌。<br>(手牌上限小于3则视为3)",
            "hanbing_gai":"寒冰改",
            "hanbing_gai_info":"根据伤害量弃置对手2*X张牌，可惜必须有属性效果。",
            qianghuazhuang:"强化装备",
            "qianghuazhuang_info":"你可以消耗经验，或弃置一至三张牌，选择一个永久效果升级。<br>（如摸牌、攻击距离、手牌上限等）每回合限两次。",
            huokongld:"火控雷达",
            "huokongld_info":"当你使用的【杀】被目标角色使用的【闪】抵消时，你可以弃置两张牌，令此【杀】依然对其造成伤害。通过强化可以减少卡牌花费。",
            "测试":"测试",
            "测试_info":"",
            ce:"ce",
            "ce_info":"",
            wa:"wa",
            "wa_info":"",
            "ganglie_gai":"刚烈弱化",
            "ganglie_gai_info":"每当你受到1伤害后，若你的体力不大于2，你可以弃置x张牌并进行判定。<br>若结果不为红桃，则伤害来源顺序选择执行一项：1.弃置x+1张手牌，2.选择交给你一张牌;3.都未执行，则其失去一点体力(无视护甲)。<br>若你先弃置了两张牌，则判定失败时可以获得目标的一张牌;目标来到选择2面前前，会额外失去一张牌。",
        },
    },
    intro:"制作组群，730255133，括号删除#(滑稽)   建议把其他武将包设为点将才能用，体验闪丰富而简单的卡牌对战<br>闪避（响应）对面的攻击，强化自己的摸牌，与队友互给关键牌，通过攻击减少对手手牌数，拉开牌差，赢得优势。 <br>雷杀对有护甲或者有失血反击技能的目标流失体力（穿甲），冰杀对有护甲的目标加1伤，火杀会让对手于出牌阶段结束后扣一血。<br>潜艇、驱逐雷杀改造战列、航母，重巡火杀改造驱逐、轻巡，战列冰杀打改造重巡，加1伤。<br>卡牌里也有作者尝试的身影，可以编辑牌堆尝试哦。",
    author:"※人杰地灵游戏中",
    diskURL:"https://pan.baidu.com/s/1JTv8QGtFu90UED_ZVYm5-A 提取码：5iox",
    forumURL:"",
    version:"1.11",
},files:{"character":["changchun.jpg"],"card":["huokongld.png"],"skill":[]}}})